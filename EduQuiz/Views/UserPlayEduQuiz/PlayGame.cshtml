@{
    Layout = "_LayoutPlay";
    ViewBag.Title = "Play Game";
}
<div class="instructions__PageWrapper">
    <main class="instructions-with-avatar__PageMainContent">
        <button id="avatar-current" class="avatar-content__AvatarContainer" style="--scale-size: -225.25px;">
            <div class="avatar-content__EditButton">
                <span class="icon__Icon">
                    <svg viewBox="0 0 32 32" focusable="false" stroke="none" stroke-width="0" aria-hidden="true"><title>Icon</title><path d="M23.4091683,8.594 C24.1731683,9.359 24.1731683,10.693 23.4091683,11.458 L22.6901683,12.178 L19.8241683,9.313 L20.5451683,8.594 C21.3101683,7.83 22.6441683,7.829 23.4091683,8.594 L23.4091683,8.594 Z M8.37616832,23.626 L8.97116832,21.252 L10.7501683,23.033 L8.37616832,23.626 Z M18.4111683,10.728 L21.2741683,13.591 L12.7061683,22.159 L9.84316832,19.296 L18.4111683,10.728 Z M24.8211683,7.179 C24.0611683,6.418 23.0501683,6 21.9741683,6 C20.9001683,6 19.8881683,6.418 19.1281683,7.179 L7.71916832,18.587 C7.71916832,18.587 7.71816832,18.59 7.71716832,18.591 C7.63616832,18.673 7.49716832,18.889 7.45616832,19.052 L6.03016832,24.757 C5.94416832,25.097 6.04516832,25.458 6.29316832,25.706 L6.29416832,25.707 L6.29616832,25.708 C6.54416832,25.956 6.90416832,26.057 7.24516832,25.972 L12.9491683,24.545 C13.1121683,24.504 13.3291683,24.365 13.4101683,24.284 C13.4111683,24.283 13.4141683,24.282 13.4141683,24.282 L24.8231683,12.873 C25.5831683,12.113 26.0021683,11.102 26.0011683,10.027 C26.0011683,8.951 25.5831683,7.941 24.8231683,7.18 L24.8211683,7.179 Z" style="fill: rgb(0, 0, 0);"></path></svg>
                </span>   
            </div>
            <div class="avatar-content__Container">
                <div class="styles__AvatarWrapper av-animation" style="width:100%;height:100%">
                    <img class="styles__AvatarItem" src="@ViewBag.Player.Accessory" />
                    <img class="styles__AvatarBase" src="@ViewBag.Player.AvatarUrl" />
                    <div class="styles__AvatarFace">
                        <img src="/src/img/eyes-blink.gif" />
                    </div>
                </div>
            </div>
        </button>
        <div class="avatar-content__AvatarMenuContainer">
            <div class="avatar-content__AvatarMenu">
                <div class="avatar-content__AvatarStyleTabs">
                    <button class="avatar-content__AvatarStyleTab active" data-menu="avatar">
                        Nhân vật
                    </button>
                    <button class="avatar-content__AvatarStyleTab" data-menu="accessory">
                        Phụ kiện
                    </button>
                </div>
                <div class="avatar-content__AvatarMenuContentContainer" >
                    <div id="avatar" class="avatar-content__AvatarMenuContent">
                        <button class="avatar-content__SelectionButton">
                            <div class="styles__AvatarWrapper" style="width:100%;height:100%">
                                <img class="styles__AvatarBase" src="/src/img/avatar/avatar1.svg" />
                            </div>
                            <div class="styles__StaticFace">
                                <svg xmlns="http://www.w3.org/2000/svg" id="Assets" viewBox="0 0 800 800">
                                    <defs>
                                    </defs>
                                    <circle cx="523.68" cy="455.68" r="59.36" style="fill:rgb(255, 255, 255)"></circle>
                                    <circle cx="517.97" cy="461.36" r="69.39" style="fill:rgb(255, 255, 255)"></circle>
                                    <circle cx="506.57" cy="461.36" r="33.28" class="right_eye_pupil_color"></circle>
                                    <circle cx="276.32" cy="455.68" r="59.36" style="fill:rgb(255, 255, 255)"></circle>
                                    <circle cx="282.03" cy="461.36" r="69.39" style="fill:rgb(255, 255, 255)"></circle>
                                    <circle cx="293.43" cy="461.36" r="33.28" class="right_eye_pupil_color"></circle>
                                    <path d="M482,652.73c.7-.29,1.2.85.62,1.41-7,6.75-29.55,23.08-82.65,23.08s-75.61-16.33-82.65-23.08c-.58-.56-.08-1.7.62-1.41,9.18,3.85,37.66,14,82,14S472.85,656.58,482,652.73Z" ></path>
                                </svg>
                            </div>
                        </button>
                        <button class="avatar-content__SelectionButton">
                            <div class="styles__AvatarWrapper" style="width:100%;height:100%">
                                <img class="styles__AvatarBase" src="/src/img/avatar/avatar2.svg" />
                            </div>
                            <div class="styles__StaticFace">
                                <svg xmlns="http://www.w3.org/2000/svg" id="Assets" viewBox="0 0 800 800">
                                    <defs>
                                    </defs>
                                    <circle cx="523.68" cy="455.68" r="59.36" style="fill:rgb(255, 255, 255)"></circle>
                                    <circle cx="517.97" cy="461.36" r="69.39" style="fill:rgb(255, 255, 255)"></circle>
                                    <circle cx="506.57" cy="461.36" r="33.28" class="right_eye_pupil_color"></circle>
                                    <circle cx="276.32" cy="455.68" r="59.36" style="fill:rgb(255, 255, 255)"></circle>
                                    <circle cx="282.03" cy="461.36" r="69.39" style="fill:rgb(255, 255, 255)"></circle>
                                    <circle cx="293.43" cy="461.36" r="33.28" class="right_eye_pupil_color"></circle>
                                    <path d="M482,652.73c.7-.29,1.2.85.62,1.41-7,6.75-29.55,23.08-82.65,23.08s-75.61-16.33-82.65-23.08c-.58-.56-.08-1.7.62-1.41,9.18,3.85,37.66,14,82,14S472.85,656.58,482,652.73Z" class="lip_color"></path>
                                </svg>
                            </div>
                        </button>
                        <button class="avatar-content__SelectionButton">
                            <div class="styles__AvatarWrapper" style="width:100%;height:100%">
                                <img class="styles__AvatarBase" src="/src/img/avatar/avatar3.svg" />
                            </div>
                            <div class="styles__StaticFace">
                                <svg xmlns="http://www.w3.org/2000/svg" id="Assets" viewBox="0 0 800 800">
                                    <defs>
                                    </defs>
                                    <circle cx="523.68" cy="455.68" r="59.36" style="fill:rgb(255, 255, 255)"></circle>
                                    <circle cx="517.97" cy="461.36" r="69.39" style="fill:rgb(255, 255, 255)"></circle>
                                    <circle cx="506.57" cy="461.36" r="33.28" class="right_eye_pupil_color"></circle>
                                    <circle cx="276.32" cy="455.68" r="59.36" style="fill:rgb(255, 255, 255)"></circle>
                                    <circle cx="282.03" cy="461.36" r="69.39" style="fill:rgb(255, 255, 255)"></circle>
                                    <circle cx="293.43" cy="461.36" r="33.28" class="right_eye_pupil_color"></circle>
                                    <path d="M482,652.73c.7-.29,1.2.85.62,1.41-7,6.75-29.55,23.08-82.65,23.08s-75.61-16.33-82.65-23.08c-.58-.56-.08-1.7.62-1.41,9.18,3.85,37.66,14,82,14S472.85,656.58,482,652.73Z" class="lip_color"></path>
                                </svg>
                            </div>
                        </button>
                        <button class="avatar-content__SelectionButton">
                            <div class="styles__AvatarWrapper" style="width:100%;height:100%">
                                <img class="styles__AvatarBase" src="/src/img/avatar/avatar4.svg" />
                            </div>
                            <div class="styles__StaticFace">
                                <svg xmlns="http://www.w3.org/2000/svg" id="Assets" viewBox="0 0 800 800">
                                    <defs>
                                    </defs>
                                    <circle cx="523.68" cy="455.68" r="59.36" style="fill:rgb(255, 255, 255)"></circle>
                                    <circle cx="517.97" cy="461.36" r="69.39" style="fill:rgb(255, 255, 255)"></circle>
                                    <circle cx="506.57" cy="461.36" r="33.28" class="right_eye_pupil_color"></circle>
                                    <circle cx="276.32" cy="455.68" r="59.36" style="fill:rgb(255, 255, 255)"></circle>
                                    <circle cx="282.03" cy="461.36" r="69.39" style="fill:rgb(255, 255, 255)"></circle>
                                    <circle cx="293.43" cy="461.36" r="33.28" class="right_eye_pupil_color"></circle>
                                    <path d="M482,652.73c.7-.29,1.2.85.62,1.41-7,6.75-29.55,23.08-82.65,23.08s-75.61-16.33-82.65-23.08c-.58-.56-.08-1.7.62-1.41,9.18,3.85,37.66,14,82,14S472.85,656.58,482,652.73Z"></path>
                                </svg>
                            </div>
                        </button>
                        <button class="avatar-content__SelectionButton">
                            <div class="styles__AvatarWrapper" style="width:100%;height:100%">
                                <img class="styles__AvatarBase" src="/src/img/avatar/avatar5.svg" />
                            </div>
                            <div class="styles__StaticFace">
                                <svg xmlns="http://www.w3.org/2000/svg" id="Assets" viewBox="0 0 800 800">
                                    <defs>
                                    </defs>
                                    <circle cx="523.68" cy="455.68" r="59.36" style="fill:rgb(255, 255, 255)"></circle>
                                    <circle cx="517.97" cy="461.36" r="69.39" style="fill:rgb(255, 255, 255)"></circle>
                                    <circle cx="506.57" cy="461.36" r="33.28" class="right_eye_pupil_color"></circle>
                                    <circle cx="276.32" cy="455.68" r="59.36" style="fill:rgb(255, 255, 255)"></circle>
                                    <circle cx="282.03" cy="461.36" r="69.39" style="fill:rgb(255, 255, 255)"></circle>
                                    <circle cx="293.43" cy="461.36" r="33.28" class="right_eye_pupil_color"></circle>
                                    <path d="M482,652.73c.7-.29,1.2.85.62,1.41-7,6.75-29.55,23.08-82.65,23.08s-75.61-16.33-82.65-23.08c-.58-.56-.08-1.7.62-1.41,9.18,3.85,37.66,14,82,14S472.85,656.58,482,652.73Z" class="lip_color"></path>
                                </svg>
                            </div>
                        </button>
                        <button class="avatar-content__SelectionButton">
                            <div class="styles__AvatarWrapper" style="width:100%;height:100%">
                                <img class="styles__AvatarBase" src="/src/img/avatar/avatar6.svg" />
                            </div>
                            <div class="styles__StaticFace">
                                <svg xmlns="http://www.w3.org/2000/svg" id="Assets" viewBox="0 0 800 800">
                                    <defs>
                                    </defs>
                                    <circle cx="523.68" cy="455.68" r="59.36" style="fill:rgb(255, 255, 255)"></circle>
                                    <circle cx="517.97" cy="461.36" r="69.39" style="fill:rgb(255, 255, 255)"></circle>
                                    <circle cx="506.57" cy="461.36" r="33.28" class="right_eye_pupil_color"></circle>
                                    <circle cx="276.32" cy="455.68" r="59.36" style="fill:rgb(255, 255, 255)"></circle>
                                    <circle cx="282.03" cy="461.36" r="69.39" style="fill:rgb(255, 255, 255)"></circle>
                                    <circle cx="293.43" cy="461.36" r="33.28" class="right_eye_pupil_color"></circle>
                                    <path d="M482,652.73c.7-.29,1.2.85.62,1.41-7,6.75-29.55,23.08-82.65,23.08s-75.61-16.33-82.65-23.08c-.58-.56-.08-1.7.62-1.41,9.18,3.85,37.66,14,82,14S472.85,656.58,482,652.73Z" class="lip_color"></path>
                                </svg>
                            </div>
                        </button>
                        <button class="avatar-content__SelectionButton">
                            <div class="styles__AvatarWrapper" style="width:100%;height:100%">
                                <img class="styles__AvatarBase" src="/src/img/avatar/avatar7.svg" />
                            </div>
                            <div class="styles__StaticFace">
                                <svg xmlns="http://www.w3.org/2000/svg" id="Assets" viewBox="0 0 800 800">
                                    <defs>
                                    </defs>
                                    <circle cx="523.68" cy="455.68" r="59.36" style="fill:rgb(255, 255, 255)"></circle>
                                    <circle cx="517.97" cy="461.36" r="69.39" style="fill:rgb(255, 255, 255)"></circle>
                                    <circle cx="506.57" cy="461.36" r="33.28" class="right_eye_pupil_color"></circle>
                                    <circle cx="276.32" cy="455.68" r="59.36" style="fill:rgb(255, 255, 255)"></circle>
                                    <circle cx="282.03" cy="461.36" r="69.39" style="fill:rgb(255, 255, 255)"></circle>
                                    <circle cx="293.43" cy="461.36" r="33.28" class="right_eye_pupil_color"></circle>
                                    <path d="M482,652.73c.7-.29,1.2.85.62,1.41-7,6.75-29.55,23.08-82.65,23.08s-75.61-16.33-82.65-23.08c-.58-.56-.08-1.7.62-1.41,9.18,3.85,37.66,14,82,14S472.85,656.58,482,652.73Z" class="lip_color"></path>
                                </svg>
                            </div>
                        </button>
                        <button class="avatar-content__SelectionButton">
                            <div class="styles__AvatarWrapper" style="width:100%;height:100%">
                                <img class="styles__AvatarBase" src="/src/img/avatar/avatar8.svg" />
                            </div>
                            <div class="styles__StaticFace">
                                <svg xmlns="http://www.w3.org/2000/svg" id="Assets" viewBox="0 0 800 800">
                                    <defs>
                                    </defs>
                                    <circle cx="523.68" cy="455.68" r="59.36" style="fill:rgb(255, 255, 255)"></circle>
                                    <circle cx="517.97" cy="461.36" r="69.39" style="fill:rgb(255, 255, 255)"></circle>
                                    <circle cx="506.57" cy="461.36" r="33.28" class="right_eye_pupil_color"></circle>
                                    <circle cx="276.32" cy="455.68" r="59.36" style="fill:rgb(255, 255, 255)"></circle>
                                    <circle cx="282.03" cy="461.36" r="69.39" style="fill:rgb(255, 255, 255)"></circle>
                                    <circle cx="293.43" cy="461.36" r="33.28" class="right_eye_pupil_color"></circle>
                                    <path d="M482,652.73c.7-.29,1.2.85.62,1.41-7,6.75-29.55,23.08-82.65,23.08s-75.61-16.33-82.65-23.08c-.58-.56-.08-1.7.62-1.41,9.18,3.85,37.66,14,82,14S472.85,656.58,482,652.73Z" class="lip_color"></path>
                                </svg>
                            </div>
                        </button>
                        <button class="avatar-content__SelectionButton">
                            <div class="styles__AvatarWrapper" style="width:100%;height:100%">
                                <img class="styles__AvatarBase" src="/src/img/avatar/avatar9.svg" />
                            </div>
                            <div class="styles__StaticFace">
                                <svg xmlns="http://www.w3.org/2000/svg" id="Assets" viewBox="0 0 800 800">
                                    <defs>
                                    </defs>
                                    <circle cx="523.68" cy="455.68" r="59.36" style="fill:rgb(255, 255, 255)"></circle>
                                    <circle cx="517.97" cy="461.36" r="69.39" style="fill:rgb(255, 255, 255)"></circle>
                                    <circle cx="506.57" cy="461.36" r="33.28" class="right_eye_pupil_color"></circle>
                                    <circle cx="276.32" cy="455.68" r="59.36" style="fill:rgb(255, 255, 255)"></circle>
                                    <circle cx="282.03" cy="461.36" r="69.39" style="fill:rgb(255, 255, 255)"></circle>
                                    <circle cx="293.43" cy="461.36" r="33.28" class="right_eye_pupil_color"></circle>
                                    <path d="M482,652.73c.7-.29,1.2.85.62,1.41-7,6.75-29.55,23.08-82.65,23.08s-75.61-16.33-82.65-23.08c-.58-.56-.08-1.7.62-1.41,9.18,3.85,37.66,14,82,14S472.85,656.58,482,652.73Z" class="lip_color"></path>
                                </svg>
                            </div>
                        </button>
                        <button class="avatar-content__SelectionButton">
                            <div class="styles__AvatarWrapper" style="width:100%;height:100%">
                                <img class="styles__AvatarBase" src="/src/img/avatar/avatar10.svg" />
                            </div>
                            <div class="styles__StaticFace">
                                <svg xmlns="http://www.w3.org/2000/svg" id="Assets" viewBox="0 0 800 800">
                                    <defs>
                                    </defs>
                                    <circle cx="523.68" cy="455.68" r="59.36" style="fill:rgb(255, 255, 255)"></circle>
                                    <circle cx="517.97" cy="461.36" r="69.39" style="fill:rgb(255, 255, 255)"></circle>
                                    <circle cx="506.57" cy="461.36" r="33.28" class="right_eye_pupil_color"></circle>
                                    <circle cx="276.32" cy="455.68" r="59.36" style="fill:rgb(255, 255, 255)"></circle>
                                    <circle cx="282.03" cy="461.36" r="69.39" style="fill:rgb(255, 255, 255)"></circle>
                                    <circle cx="293.43" cy="461.36" r="33.28" class="right_eye_pupil_color"></circle>
                                    <path d="M482,652.73c.7-.29,1.2.85.62,1.41-7,6.75-29.55,23.08-82.65,23.08s-75.61-16.33-82.65-23.08c-.58-.56-.08-1.7.62-1.41,9.18,3.85,37.66,14,82,14S472.85,656.58,482,652.73Z" class="lip_color"></path>
                                </svg>
                            </div>
                        </button>
                        <button class="avatar-content__SelectionButton">
                            <div class="styles__AvatarWrapper" style="width:100%;height:100%">
                                <img class="styles__AvatarBase" src="/src/img/avatar/avatar11.svg" />
                            </div>
                            <div class="styles__StaticFace">
                                <svg xmlns="http://www.w3.org/2000/svg" id="Assets" viewBox="0 0 800 800">
                                    <defs>
                                    </defs>
                                    <circle cx="523.68" cy="455.68" r="59.36" style="fill:rgb(255, 255, 255)"></circle>
                                    <circle cx="517.97" cy="461.36" r="69.39" style="fill:rgb(255, 255, 255)"></circle>
                                    <circle cx="506.57" cy="461.36" r="33.28" class="right_eye_pupil_color"></circle>
                                    <circle cx="276.32" cy="455.68" r="59.36" style="fill:rgb(255, 255, 255)"></circle>
                                    <circle cx="282.03" cy="461.36" r="69.39" style="fill:rgb(255, 255, 255)"></circle>
                                    <circle cx="293.43" cy="461.36" r="33.28" class="right_eye_pupil_color"></circle>
                                    <path d="M482,652.73c.7-.29,1.2.85.62,1.41-7,6.75-29.55,23.08-82.65,23.08s-75.61-16.33-82.65-23.08c-.58-.56-.08-1.7.62-1.41,9.18,3.85,37.66,14,82,14S472.85,656.58,482,652.73Z" class="lip_color"></path>
                                </svg>
                            </div>
                        </button>
                        <button class="avatar-content__SelectionButton">
                            <div class="styles__AvatarWrapper" style="width:100%;height:100%">
                                <img class="styles__AvatarBase" src="/src/img/avatar/avatar12.svg" />
                            </div>
                            <div class="styles__StaticFace">
                                <svg xmlns="http://www.w3.org/2000/svg" id="Assets" viewBox="0 0 800 800">
                                    <defs>
                                    </defs>
                                    <circle cx="523.68" cy="455.68" r="59.36" style="fill:rgb(255, 255, 255)"></circle>
                                    <circle cx="517.97" cy="461.36" r="69.39" style="fill:rgb(255, 255, 255)"></circle>
                                    <circle cx="506.57" cy="461.36" r="33.28" class="right_eye_pupil_color"></circle>
                                    <circle cx="276.32" cy="455.68" r="59.36" style="fill:rgb(255, 255, 255)"></circle>
                                    <circle cx="282.03" cy="461.36" r="69.39" style="fill:rgb(255, 255, 255)"></circle>
                                    <circle cx="293.43" cy="461.36" r="33.28" class="right_eye_pupil_color"></circle>
                                    <path d="M482,652.73c.7-.29,1.2.85.62,1.41-7,6.75-29.55,23.08-82.65,23.08s-75.61-16.33-82.65-23.08c-.58-.56-.08-1.7.62-1.41,9.18,3.85,37.66,14,82,14S472.85,656.58,482,652.73Z" class="lip_color"></path>
                                </svg>
                            </div>
                        </button>
                        <button class="avatar-content__SelectionButton">
                            <div class="styles__AvatarWrapper" style="width:100%;height:100%">
                                <img class="styles__AvatarBase" src="/src/img/avatar/avatar13.svg" />
                            </div>
                            <div class="styles__StaticFace">
                                <svg xmlns="http://www.w3.org/2000/svg" id="Assets" viewBox="0 0 800 800">
                                    <defs>
                                    </defs>
                                    <circle cx="523.68" cy="455.68" r="59.36" style="fill:rgb(255, 255, 255)"></circle>
                                    <circle cx="517.97" cy="461.36" r="69.39" style="fill:rgb(255, 255, 255)"></circle>
                                    <circle cx="506.57" cy="461.36" r="33.28" class="right_eye_pupil_color"></circle>
                                    <circle cx="276.32" cy="455.68" r="59.36" style="fill:rgb(255, 255, 255)"></circle>
                                    <circle cx="282.03" cy="461.36" r="69.39" style="fill:rgb(255, 255, 255)"></circle>
                                    <circle cx="293.43" cy="461.36" r="33.28" class="right_eye_pupil_color"></circle>
                                    <path d="M482,652.73c.7-.29,1.2.85.62,1.41-7,6.75-29.55,23.08-82.65,23.08s-75.61-16.33-82.65-23.08c-.58-.56-.08-1.7.62-1.41,9.18,3.85,37.66,14,82,14S472.85,656.58,482,652.73Z" class="lip_color"></path>
                                </svg>
                            </div>
                        </button>
                    </div>
                    <div id="accessory" class="avatar-content__AvatarMenuContent" style="display:none">
                        <button class="avatar-content__SelectionButton accessory">
                            <div class="styles__AvatarWrapper" style="width:100%;height:100%">
                                <img class="styles__AvatarItem" src="/src/img/accessory/accessory1.svg" />
                                <img class="styles__AvatarBase" src="/src/img/avatar/placeholder-avatar.svg" />
                            </div> 
                        </button>
                        <button class="avatar-content__SelectionButton accessory">
                            <div class="styles__AvatarWrapper" style="width:100%;height:100%">
                                <img class="styles__AvatarItem" src="/src/img/accessory/accessory2.svg" />
                                <img class="styles__AvatarBase" src="/src/img/avatar/placeholder-avatar.svg" />
                            </div>
                        </button>
                        <button class="avatar-content__SelectionButton accessory">
                            <div class="styles__AvatarWrapper" style="width:100%;height:100%">
                                <img class="styles__AvatarItem" src="/src/img/accessory/accessory3.svg" />
                                <img class="styles__AvatarBase" src="/src/img/avatar/placeholder-avatar.svg" />
                            </div>
                        </button>
                        <button class="avatar-content__SelectionButton accessory">
                            <div class="styles__AvatarWrapper" style="width:100%;height:100%">
                                <img class="styles__AvatarItem" src="/src/img/accessory/accessory4.svg" />
                                <img class="styles__AvatarBase" src="/src/img/avatar/placeholder-avatar.svg" />
                            </div>
                        </button>
                        <button class="avatar-content__SelectionButton accessory">
                            <div class="styles__AvatarWrapper" style="width:100%;height:100%">
                                <img class="styles__AvatarItem" src="/src/img/accessory/accessory5.svg" />
                                <img class="styles__AvatarBase" src="/src/img/avatar/placeholder-avatar.svg" />
                            </div>
                        </button>
                        <button class="avatar-content__SelectionButton accessory">
                            <div class="styles__AvatarWrapper" style="width:100%;height:100%">
                                <img class="styles__AvatarItem" src="/src/img/accessory/accessory6.svg" />
                                <img class="styles__AvatarBase" src="/src/img/avatar/placeholder-avatar.svg" />
                            </div>
                        </button>
                        <button class="avatar-content__SelectionButton accessory">
                            <div class="styles__AvatarWrapper" style="width:100%;height:100%">
                                <img class="styles__AvatarItem" src="/src/img/accessory/accessory7.svg" />
                                <img class="styles__AvatarBase" src="/src/img/avatar/placeholder-avatar.svg" />
                            </div>
                        </button>
                        <button class="avatar-content__SelectionButton accessory">
                            <div class="styles__AvatarWrapper" style="width:100%;height:100%">
                                <img class="styles__AvatarItem" src="/src/img/accessory/accessory8.svg" />
                                <img class="styles__AvatarBase" src="/src/img/avatar/placeholder-avatar.svg" />
                            </div>
                        </button>
                        <button class="avatar-content__SelectionButton accessory">
                            <div class="styles__AvatarWrapper" style="width:100%;height:100%">
                                <img class="styles__AvatarItem" src="/src/img/accessory/accessory9.svg" />
                                <img class="styles__AvatarBase" src="/src/img/avatar/placeholder-avatar.svg" />
                            </div>
                        </button>
                        <button class="avatar-content__SelectionButton accessory">
                            <div class="styles__AvatarWrapper" style="width:100%;height:100%">
                                <img class="styles__AvatarItem" src="/src/img/accessory/accessory10.svg" />
                                <img class="styles__AvatarBase" src="/src/img/avatar/placeholder-avatar.svg" />
                            </div>
                        </button>
                        <button class="avatar-content__SelectionButton accessory">
                            <div class="styles__AvatarWrapper" style="width:100%;height:100%">
                                <img class="styles__AvatarItem" src="/src/img/accessory/accessory11.svg" />
                                <img class="styles__AvatarBase" src="/src/img/avatar/placeholder-avatar.svg" />
                            </div>
                        </button>
                        <button class="avatar-content__SelectionButton accessory">
                            <div class="styles__AvatarWrapper" style="width:100%;height:100%">
                                <img class="styles__AvatarItem" src="/src/img/accessory/accessory12.svg" />
                                <img class="styles__AvatarBase" src="/src/img/avatar/placeholder-avatar.svg" />
                            </div>
                        </button>
                        <button class="avatar-content__SelectionButton accessory">
                            <div class="styles__AvatarWrapper" style="width:100%;height:100%">
                                <img class="styles__AvatarItem" src="/src/img/accessory/accessory13.svg" />
                                <img class="styles__AvatarBase" src="/src/img/avatar/placeholder-avatar.svg" />
                            </div>
                        </button> 
                        <button class="avatar-content__SelectionButton accessory">
                            <div class="styles__AvatarWrapper" style="width:100%;height:100%">
                                <img class="styles__AvatarItem" src="/src/img/accessory/accessory14.svg" />
                                <img class="styles__AvatarBase" src="/src/img/avatar/placeholder-avatar.svg" />
                            </div>
                        </button>
                        <button class="avatar-content__SelectionButton accessory">
                            <div class="styles__AvatarWrapper" style="width:100%;height:100%">
                                <img class="styles__AvatarItem" src="/src/img/accessory/accessory15.svg" />
                                <img class="styles__AvatarBase" src="/src/img/avatar/placeholder-avatar.svg" />
                            </div>
                        </button>
                        <button class="avatar-content__SelectionButton accessory">
                            <div class="styles__AvatarWrapper" style="width:100%;height:100%">
                                <img class="styles__AvatarItem" src="/src/img/accessory/accessory16.svg" />
                                <img class="styles__AvatarBase" src="/src/img/avatar/placeholder-avatar.svg" />
                            </div>
                        </button>
                    </div>
                    <button id="close-menu" class="avatar-content__SelectionDone">Xong</button>
                </div>
            </div>
        </div>
        <div class="instructions-with-avatar__TextContent">
            <h1 class="header-text__HeaderText">
                <span class="shadow-text__Container">
                    <span class="shadow-text__HiddenText">@ViewBag.Player.Nickname</span>
                    <span class="shadow-text__Text">@ViewBag.Player.Nickname</span>
                    <span class="shadow-text__Shadow">@ViewBag.Player.Nickname</span>
                </span>
            </h1>
            <h2 class="sub-header-text__SubHeaderText">
                <span class="shadow-text__Container">
                    <span class="shadow-text__HiddenText">Và thế là xong! Bạn có thấy biệt danh của mình trên màn hình không?</span>
                    <span class="shadow-text__Text">Và thế là xong! Bạn có thấy biệt danh của mình trên màn hình không?</span>
                    <span class="shadow-text__Shadow">Và thế là xong! Bạn có thấy biệt danh của mình trên màn hình không?</span>
                </span>
            </h2>
        </div>
    </main>
</div>
<script> 
    let isKicked = false;
    var flagfeedback = false;
    var bg = `@ViewBag.Player.QuizSession.EduQuiz.Theme.Source`;
    var isPlayer = `@ViewBag.Player.IsPlayer`;
    var playerid = `@ViewBag.Player.Id`;
    var pin = `@ViewBag.Player.QuizSession.Pin`;
    var avatarcurrent = `@ViewBag.Player.AvatarUrl`;
    var itemcurrent = `@ViewBag.Player.Accessory`;
    var startgame = `@ViewBag.Player.QuizSession.IsWaitingRoom`;
    var quizsessionId = `@ViewBag.Player.QuizSession.Id`;
    var isShowAvatar = `@ViewBag.Player.QuizSession.IsShowAvatar`;
    var isActive = `@ViewBag.Player.QuizSession.IsActive`;
    var arranswer = [];
    const state = {};
    const revealSequences = {
        9: [2, 6, 0, 3, 8, 1, 4, 7, 5], // 3x3
        25: [23, 1, 12, 19, 7, 8, 0, 24, 17, 15, 11, 4, 20, 2, 9, 13, 5, 21, 6, 10, 14, 3, 16, 18, 22], // 5x5
        64: [37, 5, 47, 12, 56, 0, 24, 19, 30, 35, 48, 1, 57, 4, 62, 52, 38, 10, 41, 63, 14, 33, 45, 29, 3, 27, 31, 44, 20, 7, 15, 42, 2, 39, 53, 28, 34, 59, 13, 50, 55, 8, 32, 18, 54, 11, 43, 60, 40, 16, 6, 9, 58, 61, 46, 22, 26, 36, 49, 17, 21, 25, 51, 23] // 8x8
    };
    $(".layout_Fullscreen").css("background", `url(${bg}) center center / cover no-repeat`);
    if (startgame == "False") {
        $(".instructions-with-avatar__PageMainContent").remove();
        setTimeout(() => {
            connection.invoke("ReloadConnect", pin)
                .catch(function (err) {
                    console.error(err.toString());
                });
        }, 50)
    }

    sessionStorage.setItem('isLoaded', 'true');

    let isLoaded = sessionStorage.getItem('isLoaded') === 'true';
    window.addEventListener('load', function () {
        if (performance.navigation.type === 1) {
            if (isLoaded && isPlayer === 'False') {
                window.location.href = "/pin";
            }else{ 
                if (isActive == "True"){
                    setTimeout(() => {
                        connection.invoke("ReloadConnect", pin)
                            .catch(function (err) {
                                console.error(err.toString());
                            });
                    }, 150)
                }else{
                    window.location.href = "/pin";
                }
            }
        }
    })

    // Sự kiện khi làm mới trang
    $(window).on('beforeunload', function (event) {
        if (!isKicked) {
            event.preventDefault();
            event.returnValue = 'Các thay đổi bạn đã thực hiện có thể không được lưu.';
        }
    });
    // Sự kiện unload
    $(window).on('unload', function () {     
            connection.invoke("PlayerOutRoom", pin, parseInt(playerid, 10))
                .catch(function (err) {
                    console.error(err.toString());
                });
    });
    function changeAvartar() {
        var urlItem = $(".styles__AvatarItem").attr("src");
        var urlavatar = $(".styles__AvatarBase").attr("src");
        avatarcurrent = urlavatar;
        itemcurrent = urlItem;
        connection.invoke("ChangeAvatar", pin, parseInt(playerid, 10), urlItem, urlavatar)
            .catch(function (err) {
                console.error(err.toString());
            });
    }
    const connection = new signalR.HubConnectionBuilder()
        .withUrl("/gameHub")
        .build();

    connection.start().then(function () {
        console.log("SignalR connected.");
        connection.invoke("ReConnectPlayer", pin)
            .catch(function (err) {
                console.error(err.toString());
            });
    }).catch(function (err) {
        return console.error(err.toString());
    });
    connection.on("OptionAvatar", function (option) {  
        OptionAvatar(option);
    });
    $(document).on("click", '.rating', function () {
        $('.rating').removeClass('selected');
        $(this).nextAll().addBack().addClass('selected');
        $('#submitfeedback').attr("disabled", false);
    });
    function changeColor(button, category, type) {
        const buttons = document.querySelectorAll(`.btn-feedback.${category} .icon__Icon path`);
        buttons.forEach(btn => btn.style.fill = 'rgb(178, 178, 178)');
        if (type === 'yes') {
            button.querySelector('.icon__Icon path').style.fill = 'rgb(102, 191, 57)';
        } else if (type === 'no') {
            button.querySelector('.icon__Icon path').style.fill = 'rgb(226, 27, 60)';
        } else {
            button.querySelector('.icon__Icon path').style.fill = 'rgb(255, 166, 2)';
        }
        state[category] = type;
        console.log(state);
        toggleSubmitButton();
    }
    function toggleSubmitButton() {
        const submitButton = $('#submitfeedback');
        // Kiểm tra nếu state không rỗng
        if (Object.keys(state).length > 0) {
            submitButton.attr("disabled", false);
        } else {
            submitButton.attr("disabled", true);
        }
    }
    function sendFeedback() {
        let rating = $('.rating.selected').length;
        let data = {
            QuizSessionId: quizsessionId,
        };
        if (rating != 0) {
            data["Rating"] = rating;
        }

        if (state['learning']) {
            data['PositiveLearningOutcome'] = state['learning'] === 'yes' ? true : false;
        }

        if (state['liking']) {
            data['Liked'] = state['liking'] === 'yes' ? true : false;
        }

        if (state['feeling']) {
            data['PositiveFeeling'] = state['feeling'] === 'yes' ? 1 : state['feeling'] === 'nor' ? 2 : 0;
        }
        $.ajax({
            url: '@Url.Action("SaveFeedback", "UserPlayEduQuiz")',
            type: 'POST',
            data: data,
            success: function (response) {
                $(".feedback__Form").remove();
                $(".feedback__PageMainContent").append(`<div class="result__Feedback">
                    <h1 class="result__Feedback-Title">Cảm ơn bạn đã tham gia đánh giá phản hồi</h1>
                    <span style="font-weight:bold;font-size:24px">Tốt lắm!</span>
                    <span class="icon__Icon" style="width:50px;height:50px;">
                        <svg viewBox="0 0 32 32" focusable="false" stroke="none" stroke-width="0" aria-hidden="true"><title>Icon</title><path d="M16,0 C24.8363636,0 32,7.16363636 32,16 C32,24.8363636 24.8363636,32 16,32 C7.16363636,32 0,24.8363636 0,16 C0,7.16363636 7.16363636,0 16,0 Z M21.8181818,17.0909091 C21.8181818,16.4 21.2727273,15.8181818 20.5818182,15.8181818 C21.2727273,15.8181818 21.8181818,15.2727273 21.8181818,14.5818182 C21.8181818,13.8909091 21.2727273,13.3454545 20.5818182,13.3454545 L15.6727273,13.3454545 L16.6181818,10.8363636 C17.1272727,9.45454545 16.4727273,7.96363636 15.1272727,7.45454545 C13.7818182,6.98181818 12.2909091,7.67272727 11.7818182,9.05454545 L10.1818182,13.3454545 L10.1818182,23.3090909 L15.4181818,23.3090909 L20.5818182,23.3090909 C21.2727273,23.3090909 21.8181818,22.7272727 21.8181818,22.0363636 C21.8181818,21.3454545 21.2727273,20.8 20.5818182,20.8 C21.2727273,20.8 21.8181818,20.2545455 21.8181818,19.5636364 C21.8181818,18.8727273 21.2727273,18.3272727 20.5818182,18.3272727 C21.2727273,18.3272727 21.8181818,17.7818182 21.8181818,17.0909091 Z" style="fill: rgb(102, 191, 57);"></path></svg>
                    </span>
                    <span style="font-size:16px;margin-top:1rem;">Chúng tôi sẽ làm việc chăm chỉ để cải thiện trải nghiệm của người chơi.</span>
                </div>`);
            },
            error: function (error) {
                console.error('Error:', error);
            }
        });
    }
    connection.on("Getfeedback", function () {
        if (!flagfeedback) {
            $(".instructions__PageWrapper").remove();
            $(".layout_Fullscreen").append(`<div class="feedback__PageMainContent">
                <div class="feedback__Form">
                    <h1 class="feedback__Title">Lấy ý kiến đánh giá</h1>
                    <div class="styles__InputField">
                        <div class="styles__InputField-Title">Bạn đánh giá thế nào về EduQuiz này?</div>
                        <div class="styles__InputField-Wrapper">
                            <button class="btn-feedback rating">
                                <span class="icon__Icon" style="width:40px;height:40px;">
                                    <svg height="40px" width="40px" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
                                         viewBox="0 0 47.94 47.94" xml:space="preserve">
                                    <path style="fill:rgb(178, 178, 178);" d="M26.285,2.486l5.407,10.956c0.376,0.762,1.103,1.29,1.944,1.412l12.091,1.757
                                        c2.118,0.308,2.963,2.91,1.431,4.403l-8.749,8.528c-0.608,0.593-0.886,1.448-0.742,2.285l2.065,12.042
                                        c0.362,2.109-1.852,3.717-3.746,2.722l-10.814-5.685c-0.752-0.395-1.651-0.395-2.403,0l-10.814,5.685
                                        c-1.894,0.996-4.108-0.613-3.746-2.722l2.065-12.042c0.144-0.837-0.134-1.692-0.742-2.285l-8.749-8.528
                                        c-1.532-1.494-0.687-4.096,1.431-4.403l12.091-1.757c0.841-0.122,1.568-0.65,1.944-1.412l5.407-10.956
                                        C22.602,0.567,25.338,0.567,26.285,2.486z" />
                                    </svg>
                                </span>
                            </button>
                            <button class="btn-feedback rating">
                                <span class="icon__Icon" style="width:40px;height:40px;">
                                    <svg height="40px" width="40px" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
                                         viewBox="0 0 47.94 47.94" xml:space="preserve">
                                    <path style="fill:rgb(178, 178, 178);" d="M26.285,2.486l5.407,10.956c0.376,0.762,1.103,1.29,1.944,1.412l12.091,1.757
                                        c2.118,0.308,2.963,2.91,1.431,4.403l-8.749,8.528c-0.608,0.593-0.886,1.448-0.742,2.285l2.065,12.042
                                        c0.362,2.109-1.852,3.717-3.746,2.722l-10.814-5.685c-0.752-0.395-1.651-0.395-2.403,0l-10.814,5.685
                                        c-1.894,0.996-4.108-0.613-3.746-2.722l2.065-12.042c0.144-0.837-0.134-1.692-0.742-2.285l-8.749-8.528
                                        c-1.532-1.494-0.687-4.096,1.431-4.403l12.091-1.757c0.841-0.122,1.568-0.65,1.944-1.412l5.407-10.956
                                        C22.602,0.567,25.338,0.567,26.285,2.486z" />
                                    </svg>
                                </span>
                            </button>
                            <button class="btn-feedback rating">
                                <span class="icon__Icon" style="width:40px;height:40px;">
                                    <svg height="40px" width="40px" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
                                         viewBox="0 0 47.94 47.94" xml:space="preserve">
                                    <path style="fill:rgb(178, 178, 178);" d="M26.285,2.486l5.407,10.956c0.376,0.762,1.103,1.29,1.944,1.412l12.091,1.757
                                        c2.118,0.308,2.963,2.91,1.431,4.403l-8.749,8.528c-0.608,0.593-0.886,1.448-0.742,2.285l2.065,12.042
                                        c0.362,2.109-1.852,3.717-3.746,2.722l-10.814-5.685c-0.752-0.395-1.651-0.395-2.403,0l-10.814,5.685
                                        c-1.894,0.996-4.108-0.613-3.746-2.722l2.065-12.042c0.144-0.837-0.134-1.692-0.742-2.285l-8.749-8.528
                                        c-1.532-1.494-0.687-4.096,1.431-4.403l12.091-1.757c0.841-0.122,1.568-0.65,1.944-1.412l5.407-10.956
                                        C22.602,0.567,25.338,0.567,26.285,2.486z" />
                                    </svg>
                                </span>
                            </button>
                            <button class="btn-feedback rating">
                                <span class="icon__Icon" style="width:40px;height:40px;">
                                    <svg height="40px" width="40px" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
                                         viewBox="0 0 47.94 47.94" xml:space="preserve">
                                    <path style="fill:rgb(178, 178, 178);" d="M26.285,2.486l5.407,10.956c0.376,0.762,1.103,1.29,1.944,1.412l12.091,1.757
                                        c2.118,0.308,2.963,2.91,1.431,4.403l-8.749,8.528c-0.608,0.593-0.886,1.448-0.742,2.285l2.065,12.042
                                        c0.362,2.109-1.852,3.717-3.746,2.722l-10.814-5.685c-0.752-0.395-1.651-0.395-2.403,0l-10.814,5.685
                                        c-1.894,0.996-4.108-0.613-3.746-2.722l2.065-12.042c0.144-0.837-0.134-1.692-0.742-2.285l-8.749-8.528
                                        c-1.532-1.494-0.687-4.096,1.431-4.403l12.091-1.757c0.841-0.122,1.568-0.65,1.944-1.412l5.407-10.956
                                        C22.602,0.567,25.338,0.567,26.285,2.486z" />
                                    </svg>
                                </span>
                            </button>
                            <button class="btn-feedback rating">
                                <span class="icon__Icon" style="width:40px;height:40px;">
                                    <svg height="40px" width="40px" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
                                         viewBox="0 0 47.94 47.94" xml:space="preserve">
                                    <path style="fill:rgb(178, 178, 178);" d="M26.285,2.486l5.407,10.956c0.376,0.762,1.103,1.29,1.944,1.412l12.091,1.757
                                        c2.118,0.308,2.963,2.91,1.431,4.403l-8.749,8.528c-0.608,0.593-0.886,1.448-0.742,2.285l2.065,12.042
                                        c0.362,2.109-1.852,3.717-3.746,2.722l-10.814-5.685c-0.752-0.395-1.651-0.395-2.403,0l-10.814,5.685
                                        c-1.894,0.996-4.108-0.613-3.746-2.722l2.065-12.042c0.144-0.837-0.134-1.692-0.742-2.285l-8.749-8.528
                                        c-1.532-1.494-0.687-4.096,1.431-4.403l12.091-1.757c0.841-0.122,1.568-0.65,1.944-1.412l5.407-10.956
                                        C22.602,0.567,25.338,0.567,26.285,2.486z" />
                                    </svg>
                                </span>
                            </button>
                        </div>
                    </div>
                    <div class="styles__InputField">
                        <div class="styles__InputField-Title">Bạn có học được điều gì không?</div>
                        <div class="styles__InputField-Wrapper">
                            <button class="btn-feedback learning" onclick="changeColor(this,'learning', 'no')">
                                <span class="icon__Icon" style="width:40px;height:40px;">
                                    <svg viewBox="0 0 32 32" focusable="false" stroke="none" stroke-width="0" aria-hidden="true"><title>Icon</title><path d="M16,32 C7.16363636,32 0,24.8363636 0,16 C0,7.16363636 7.16363636,0 16,0 C24.8363636,0 32,7.16363636 32,16 C32,24.8363636 24.8363636,32 16,32 Z M10.1818182,14.9090909 C10.1818182,15.6 10.7272727,16.1818182 11.4181818,16.1818182 C10.7272727,16.1818182 10.1818182,16.7272727 10.1818182,17.4181818 C10.1818182,18.1090909 10.7272727,18.6545455 11.4181818,18.6545455 L16.3272727,18.6545455 L15.3818182,21.1636364 C14.8727273,22.5454545 15.5272727,24.0363636 16.8727273,24.5454545 C18.2181818,25.0181818 19.7090909,24.3272727 20.2181818,22.9454545 L21.8181818,18.6545455 L21.8181818,8.69090909 L16.5818182,8.69090909 L11.4181818,8.69090909 C10.7272727,8.69090909 10.1818182,9.27272727 10.1818182,9.96363636 C10.1818182,10.6545455 10.7272727,11.2 11.4181818,11.2 C10.7272727,11.2 10.1818182,11.7454545 10.1818182,12.4363636 C10.1818182,13.1272727 10.7272727,13.6727273 11.4181818,13.6727273 C10.7272727,13.6727273 10.1818182,14.2181818 10.1818182,14.9090909 Z" style="fill: rgb(178, 178, 178);"></path></svg>
                                </span>
                            </button>
                            <button class="btn-feedback learning" onclick="changeColor(this,'learning', 'yes')">
                                <span class="icon__Icon" style="width:40px;height:40px;">
                                    <svg viewBox="0 0 32 32" focusable="false" stroke="none" stroke-width="0" aria-hidden="true"><title>Icon</title><path d="M16,0 C24.8363636,0 32,7.16363636 32,16 C32,24.8363636 24.8363636,32 16,32 C7.16363636,32 0,24.8363636 0,16 C0,7.16363636 7.16363636,0 16,0 Z M21.8181818,17.0909091 C21.8181818,16.4 21.2727273,15.8181818 20.5818182,15.8181818 C21.2727273,15.8181818 21.8181818,15.2727273 21.8181818,14.5818182 C21.8181818,13.8909091 21.2727273,13.3454545 20.5818182,13.3454545 L15.6727273,13.3454545 L16.6181818,10.8363636 C17.1272727,9.45454545 16.4727273,7.96363636 15.1272727,7.45454545 C13.7818182,6.98181818 12.2909091,7.67272727 11.7818182,9.05454545 L10.1818182,13.3454545 L10.1818182,23.3090909 L15.4181818,23.3090909 L20.5818182,23.3090909 C21.2727273,23.3090909 21.8181818,22.7272727 21.8181818,22.0363636 C21.8181818,21.3454545 21.2727273,20.8 20.5818182,20.8 C21.2727273,20.8 21.8181818,20.2545455 21.8181818,19.5636364 C21.8181818,18.8727273 21.2727273,18.3272727 20.5818182,18.3272727 C21.2727273,18.3272727 21.8181818,17.7818182 21.8181818,17.0909091 Z" style="fill: rgb(178, 178, 178);"></path></svg>
                                </span>
                            </button>
                        </div>
                    </div>
                    <div class="styles__InputField">
                        <div class="styles__InputField-Title">Bạn có thích nó không?</div>
                        <div class="styles__InputField-Wrapper">
                            <button class="btn-feedback liking" onclick="changeColor(this,'liking', 'no')">
                                <span class="icon__Icon" style="width:40px;height:40px;">
                                    <svg viewBox="0 0 32 32" focusable="false" stroke="none" stroke-width="0" aria-hidden="true"><title>Icon</title><path d="M16,32 C7.16363636,32 0,24.8363636 0,16 C0,7.16363636 7.16363636,0 16,0 C24.8363636,0 32,7.16363636 32,16 C32,24.8363636 24.8363636,32 16,32 Z M10.1818182,14.9090909 C10.1818182,15.6 10.7272727,16.1818182 11.4181818,16.1818182 C10.7272727,16.1818182 10.1818182,16.7272727 10.1818182,17.4181818 C10.1818182,18.1090909 10.7272727,18.6545455 11.4181818,18.6545455 L16.3272727,18.6545455 L15.3818182,21.1636364 C14.8727273,22.5454545 15.5272727,24.0363636 16.8727273,24.5454545 C18.2181818,25.0181818 19.7090909,24.3272727 20.2181818,22.9454545 L21.8181818,18.6545455 L21.8181818,8.69090909 L16.5818182,8.69090909 L11.4181818,8.69090909 C10.7272727,8.69090909 10.1818182,9.27272727 10.1818182,9.96363636 C10.1818182,10.6545455 10.7272727,11.2 11.4181818,11.2 C10.7272727,11.2 10.1818182,11.7454545 10.1818182,12.4363636 C10.1818182,13.1272727 10.7272727,13.6727273 11.4181818,13.6727273 C10.7272727,13.6727273 10.1818182,14.2181818 10.1818182,14.9090909 Z" style="fill: rgb(178, 178, 178);"></path></svg>
                                </span>
                            </button>
                            <button class="btn-feedback liking" onclick="changeColor(this,'liking', 'yes')">
                                <span class="icon__Icon" style="width:40px;height:40px;">
                                    <svg viewBox="0 0 32 32" focusable="false" stroke="none" stroke-width="0" aria-hidden="true"><title>Icon</title><path d="M16,0 C24.8363636,0 32,7.16363636 32,16 C32,24.8363636 24.8363636,32 16,32 C7.16363636,32 0,24.8363636 0,16 C0,7.16363636 7.16363636,0 16,0 Z M21.8181818,17.0909091 C21.8181818,16.4 21.2727273,15.8181818 20.5818182,15.8181818 C21.2727273,15.8181818 21.8181818,15.2727273 21.8181818,14.5818182 C21.8181818,13.8909091 21.2727273,13.3454545 20.5818182,13.3454545 L15.6727273,13.3454545 L16.6181818,10.8363636 C17.1272727,9.45454545 16.4727273,7.96363636 15.1272727,7.45454545 C13.7818182,6.98181818 12.2909091,7.67272727 11.7818182,9.05454545 L10.1818182,13.3454545 L10.1818182,23.3090909 L15.4181818,23.3090909 L20.5818182,23.3090909 C21.2727273,23.3090909 21.8181818,22.7272727 21.8181818,22.0363636 C21.8181818,21.3454545 21.2727273,20.8 20.5818182,20.8 C21.2727273,20.8 21.8181818,20.2545455 21.8181818,19.5636364 C21.8181818,18.8727273 21.2727273,18.3272727 20.5818182,18.3272727 C21.2727273,18.3272727 21.8181818,17.7818182 21.8181818,17.0909091 Z" style="fill: rgb(178, 178, 178);"></path></svg>
                                </span>
                            </button>
                        </div>
                    </div>
                    <div class="styles__InputField">
                        <div class="styles__InputField-Title">Hãy cho chúng tôi biết bạn cảm thấy thế nào?</div>
                        <div class="styles__InputField-Wrapper">
                            <button class="btn-feedback feeling" onclick="changeColor(this,'feeling', 'no')">
                                <span class="icon__Icon" style="width:40px;height:40px;">
                                    <svg viewBox="0 0 32 32" focusable="false" stroke="none" stroke-width="0" aria-hidden="true"><title>Icon</title><path d="M16,0 C7.16363636,0 0,7.16363636 0,16 C0,24.8363636 7.16363636,32 16,32 C24.8363636,32 32,24.8363636 32,16 C32,7.16363636 24.8363636,0 16,0 Z M10.1818182,9.45454545 C11.3818182,9.45454545 12.3636364,10.4363636 12.3636364,11.6363636 C12.3636364,12.8363636 11.3818182,13.8181818 10.1818182,13.8181818 C8.98181818,13.8181818 8,12.8363636 8,11.6363636 C8,10.4363636 8.98181818,9.45454545 10.1818182,9.45454545 Z M20.5090909,24 C20.5090909,21.4909091 18.4727273,19.4909091 16,19.4909091 C13.4909091,19.4909091 11.4909091,21.5272727 11.4909091,24 L8,24 C8,19.5636364 11.5636364,16 16,16 C20.4363636,16 24,19.5636364 24,24 L20.5090909,24 Z M21.8181818,13.8181818 C20.6181818,13.8181818 19.6363636,12.8363636 19.6363636,11.6363636 C19.6363636,10.4363636 20.6181818,9.45454545 21.8181818,9.45454545 C23.0181818,9.45454545 24,10.4363636 24,11.6363636 C24,12.8363636 23.0181818,13.8181818 21.8181818,13.8181818 Z" style="fill: rgb(178, 178, 178);"></path></svg>
                                </span>
                            </button>
                            <button class="btn-feedback feeling" onclick="changeColor(this,'feeling', 'nor')">
                                <span class="icon__Icon" style="width:40px;height:40px;">
                                    <svg viewBox="0 0 32 32" focusable="false" stroke="none" stroke-width="0" aria-hidden="true"><title>Icon</title><path d="M16,0 C7.15428571,0 0,7.15428571 0,16 C0,24.8457143 7.15428571,32 16,32 C24.8457143,32 32,24.8457143 32,16 C32,7.15428571 24.8457143,0 16,0 Z M10.1714286,9.46285714 C11.36,9.46285714 12.3428571,10.4457143 12.3428571,11.6342857 C12.3428571,12.8228571 11.36,13.8057143 10.1714286,13.8057143 C8.98285714,13.8057143 8,12.8457143 8,11.6342857 C8,10.4228571 8.98285714,9.46285714 10.1714286,9.46285714 Z M24,21.8285714 L8,21.8285714 L8,18.1714286 L24,18.1714286 L24,21.8285714 Z M21.8285714,13.8285714 C20.64,13.8285714 19.6571429,12.8457143 19.6571429,11.6571429 C19.6571429,10.4685714 20.64,9.48571429 21.8285714,9.48571429 C23.0171429,9.48571429 24,10.4685714 24,11.6571429 C24,12.8457143 23.0171429,13.8285714 21.8285714,13.8285714 Z" style="fill: rgb(178, 178, 178);"></path></svg>
                                </span>
                            </button>
                            <button class="btn-feedback feeling" onclick="changeColor(this,'feeling', 'yes')">
                                <span class="icon__Icon" style="width:40px;height:40px;">
                                    <svg viewBox="0 0 32 32" focusable="false" stroke="none" stroke-width="0" aria-hidden="true"><title>Icon</title><path d="M16,0 C7.16363636,0 0,7.16363636 0,16 C0,24.8363636 7.16363636,32 16,32 C24.8363636,32 32,24.8363636 32,16 C32,7.16363636 24.8363636,0 16,0 Z M10.1818182,9.45454545 C11.3818182,9.45454545 12.3636364,10.4363636 12.3636364,11.6363636 C12.3636364,12.8363636 11.3818182,13.8181818 10.1818182,13.8181818 C8.98181818,13.8181818 8,12.8363636 8,11.6363636 C8,10.4363636 8.98181818,9.45454545 10.1818182,9.45454545 Z M16,24 C11.5636364,24 8,20.2181818 8,16 L24,16 C24,20.2181818 20.4363636,24 16,24 Z M21.8181818,13.8181818 C20.6181818,13.8181818 19.6363636,12.8363636 19.6363636,11.6363636 C19.6363636,10.4363636 20.6181818,9.45454545 21.8181818,9.45454545 C23.0181818,9.45454545 24,10.4363636 24,11.6363636 C24,12.8363636 23.0181818,13.8181818 21.8181818,13.8181818 Z" style="fill:rgb(178, 178, 178);"></path></svg>
                                </span>
                            </button>
                        </div>
                    </div>
                    <div class="feedback__ButtonWrapper">
                        <button id="submitfeedback" class="btn" disabled style="background:rgb(38, 137, 12)" onclick="sendFeedback()">Gửi</button>
                    </div>
                </div>
            </div>`);
        }
    });
    connection.on("FinishedQuiz", function (data) { 
        $(".instructions-with-avatar__PageMainContent").remove();
        $(".bottom-bar__BottomBar").remove();
        const currentPlayer = data.find(player => player.id === parseInt(playerid, 10));
        const rank = data.indexOf(currentPlayer) + 1;
        const checkIsShowAvatar = isShowAvatar == "True" ? `<div class="podium__AvatarContainer">
                                                            <div class="styles__AvatarWrapper" style="width:170px;height:170px;margin-top:15px;">
                                                                            <img class="styles__AvatarItem" src="${itemcurrent}" />
                                                        <img class="styles__AvatarBase" src="${avatarcurrent}" />
                                                                <div class="styles__AvatarFace">
                                                                    <img src="/src/img/eyes-blink.gif" />
                                                                </div>
                                                            </div>
                                                                <div class="ribbon__Wrapper">
                                                                    <img src="/src/img/podium.png" />
                                                                </div>
                                                           </div>` : "";
        $(".instructions__PageWrapper").append(`<main class="instructions-with-avatar__PageMainContent">
                    <div class="instructions-with-avatar__TextContent">
                                    <h1 class="header-text__HeaderText">
                                        <span class="shadow-text__Container">
                                            <span class="shadow-text__HiddenText">Top ${rank}</span>
                                            <span class="shadow-text__Text">Top ${rank}</span>
                                            <span class="shadow-text__Shadow">Top ${rank}</span>
                                        </span>
                                    </h1>
                                    ${checkIsShowAvatar}
                                    <h1 class="header-text__HeaderText">
                                        <span class="shadow-text__Container">
                                            <span class="shadow-text__HiddenText">${currentPlayer.nickname}</span>
                                            <span class="shadow-text__Text">${currentPlayer.nickname}</span>
                                            <span class="shadow-text__Shadow">${currentPlayer.nickname}</span>
                                        </span>
                                    </h1>
                                    <h2 class="sub-header-text__SubHeaderText">
                                        <span class="shadow-text__Container">
                                            <span class="shadow-text__HiddenText">· ${currentPlayer.totalScore} điểm ·</span>
                                            <span class="shadow-text__Text">· ${currentPlayer.totalScore} điểm ·</span>
                                            <span class="shadow-text__Shadow">· ${currentPlayer.totalScore} điểm ·</span>
                                        </span>
                                    </h2>
                                    </div>
                                        </main>`);
    })
    connection.on("ReloadQuestion", function (timecountdown,questionIndex) {
        const storedData = JSON.parse(sessionStorage.getItem('question-player-params')) || { quizOption: {}, question: {}, currentQuestionIndex: 0 };
        // Tăng chỉ số câu hỏi hiện tại
        storedData.currentQuestionIndex = questionIndex; // Tăng chỉ số câu hỏi
        sessionStorage.setItem('question-player-params', JSON.stringify(storedData));
        if (timecountdown != 0 && Object.keys(storedData.question).length !== 0) {
            RenderQuestion(timecountdown);
        } 
        else{
            $(".instructions-with-avatar__PageMainContent").remove();
            $(".bottom-bar__BottomBar").remove();
            let scores = parseInt(sessionStorage.getItem("scores")) || 0;
            const checkIsShowAvatar = isShowAvatar == "True" ? `<div class="styles__AvatarWrapper" style="width:80px;height:80px;margin-bottom:15px;">
                                                                      <img class="styles__AvatarItem" src="${itemcurrent}" />
                                                        <img class="styles__AvatarBase" src="${avatarcurrent}" />
                                                            <div class="styles__AvatarFace">
                                                                <img src="/src/img/eyes-blink.gif" />
                                                            </div>
                                                        </div>` : "";
            $(".instructions__PageWrapper").append(`<main class="instructions-with-avatar__PageMainContent">
                <div class="instructions-with-avatar__TextContent">
                                <h1 class="header-text__HeaderText">
                                    <span class="shadow-text__Container">
                                        <span class="shadow-text__HiddenText">Chuẩn bị!</span>
                                        <span class="shadow-text__Text">Chuẩn bị!</span>
                                        <span class="shadow-text__Shadow">Chuẩn bị!</span>
                                    </span>
                                </h1>
                                <div class="spinner__Container">
                                    <svg id="Layer_Loader" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 140 140" enable-background="new 0 0 140 140" xml:space="preserve" color="#fff" aria-label="Merci de patienter" data-functional-selector="spinner" class="spinner__Spinner-sc-r6rcac-1 civXet"><g><circle opacity="0" fill="#FFFFFF" cx="70" cy="70" r="70"></circle><g><path fill="#FFFFFF" d="M70,0C31.3,0,0,31.3,0,70h35c0-19.3,15.7-35,35-35s35,15.7,35,35h35C140,31.3,108.7,0,70,0z"></path></g></g></svg>
                                </div>
                                <h2 class="sub-header-text__SubHeaderText">
                                    <span class="shadow-text__Container">
                                        <span class="shadow-text__HiddenText">Đang tải...</span>
                                        <span class="shadow-text__Text">Đang tải...</span>
                                        <span class="shadow-text__Shadow">Đang tải...</span>
                                    </span>
                                </h2>
                                </div>
                                    </main>
                                    <div class="bottom-bar__BottomBar">
                                                                ${checkIsShowAvatar}
                                                        <div class="bottom-bar__NameWrapper">
                                                            <span class="bottom-bar__NicknameSection">@ViewBag.Player.Nickname</span>
                                                        </div>
                                                            <div class="bottom-bar-score">${scores}</div>
                                                    </div>`);
        }
    });
    connection.on("TimeUp", function (data) {
        const parsedPlayerId = parseInt(playerid, 10);
        const playerAnswers = data.filter(answer => answer.playerId === parsedPlayerId);
        let messageHTML = '';
        let totalPoints = 0;
        let isCorrect = false;

        if (playerAnswers.length > 0) {
            playerAnswers.forEach(playerAnswer => {
                totalPoints += playerAnswer.isCorrect ? playerAnswer.score : 0;
                if (playerAnswer.isCorrect) {
                    isCorrect = true;
                }
            });
            messageHTML = isCorrect ? `
                <h1 class="header-text__HeaderText">
                    <span class="shadow-text__Container">
                        <span class="shadow-text__HiddenText">Câu trả lời đúng</span>
                        <span class="shadow-text__Text">Câu trả lời đúng</span>
                        <span class="shadow-text__Shadow">Câu trả lời đúng</span>
                    </span>
                </h1>
                <svg xmlns="http://www.w3.org/2000/svg" width="80" height="80" viewBox="0 0 80 80"><g fill="none" fill-rule="evenodd"><g><g><g><g transform="translate(-703 -1807) translate(536 1581) translate(46 170) translate(121 56)"><circle cx="40" cy="40" r="37.895" fill="#66BF39" stroke="#FFF" stroke-width="4.211"></circle><g fill="#FFF" fill-rule="nonzero" stroke="#000" stroke-opacity="0.15" stroke-width="2.105"><path d="M46.244 15.355l8.127 7.393-25.623 28.184-15.526-14.483 7.743-7.747 7.333 6.396 17.946-19.743z" transform="translate(6.316 6.316) rotate(-3 33.81 33.138)"></path></g></g></g></g></g></g></svg>
                <div class="points__Points">
                        <span class="points__Score">+ ${totalPoints}</span>
                </div>
            ` : `
                <h1 class="header-text__HeaderText">
                    <span class="shadow-text__Container">
                        <span class="shadow-text__HiddenText">Câu trả lời sai</span>
                        <span class="shadow-text__Text">Câu trả lời sai</span>
                        <span class="shadow-text__Shadow">Câu trả lời sai</span>
                    </span>
                </h1>
                <svg xmlns="http://www.w3.org/2000/svg" width="80" height="80" viewBox="0 0 80 80"><g fill="none" fill-rule="evenodd"><g><g><g><g transform="translate(-257 -1827) translate(90 1581) translate(47 190) translate(120 56)"><circle cx="40" cy="40" r="37.895" fill="#F35" stroke="#FFF" stroke-width="4.211"></circle><g fill="#FFF" fill-rule="nonzero" stroke="#000" stroke-opacity="0.15" stroke-width="2.105"><path d="M39.99 12.621v14.736l14.736.001V39.99H39.99v14.736H27.359V39.99H12.62V27.359h14.736l.001-14.737H39.99z" transform="translate(6.316 6.316) rotate(-135 33.674 33.674)"></path></g></g></g></g></g></g></svg>
                <div class="points__Points">
                    <span class="points__Score">Không có điểm</span>
                </div>
            `;
        } else {
            messageHTML = `
                <h1 class="header-text__HeaderText">
                    <span class="shadow-text__Container">
                        <span class="shadow-text__HiddenText">Không có đáp án</span>
                        <span class="shadow-text__Text">Không có đáp án</span>
                        <span class="shadow-text__Shadow">Không có đáp án</span>
                    </span>
                </h1>
                <div class="points__Points">
                    <span class="points__Score">Hãy tập trung hơn!</span>
                </div>
            `;
        }
        let scores = parseInt(sessionStorage.getItem("scores")) || 0;
        const storedData = JSON.parse(sessionStorage.getItem('question-player-params'));
        // Cập nhật điểm số
        if (isCorrect) {
            scores += totalPoints;
            sessionStorage.setItem("scores", scores);
        }
        const checkIsShowAvatar = storedData.quizOption.isShowAvatar == true ? `<div class="styles__AvatarWrapper" style="width:80px;height:80px;margin-bottom:15px;">
                                                              <img class="styles__AvatarItem" src="${itemcurrent}" />
                                                        <img class="styles__AvatarBase" src="${avatarcurrent}" />
                                                    <div class="styles__AvatarFace">
                                                        <img src="/src/img/eyes-blink.gif" />
                                                    </div>
                                                </div>` : "";
        // Cập nhật nội dung HTML
        $(".bottom-bar__BottomBar").remove();
        $(".instructions-with-avatar__PageMainContent").remove();
        $(".question-results__PageWrapper").remove();
        $(".instructions__PageWrapper").append(`
            <main class="instructions-with-avatar__PageMainContent">
            <div class="instructions-with-avatar__TextContent">
                ${messageHTML}
                <h2 class="sub-header-text__SubHeaderText">
                    <span class="shadow-text__Container">
                        <span class="shadow-text__HiddenText">Điểm tổng của bạn ở phía dưới!</span>
                        <span class="shadow-text__Text">Điểm tổng của bạn ở phía dưới!</span>
                        <span class="shadow-text__Shadow">Điểm tổng của bạn ở phía dưới!</span>
                    </span>
                </h2>
            </div>
            </main>
                <div class="bottom-bar__BottomBar">
                                            ${checkIsShowAvatar}
                                            <div class="bottom-bar__NameWrapper">
                                                <span class="bottom-bar__NicknameSection">@ViewBag.Player.Nickname</span>
                                            </div>
                                                <div class="bottom-bar-score">${scores}</div>
                                        </div>
        `);
        $(".bottom-bar-score").text(scores);
    });
    function applyGridRevealEffect(gridSize, totalTransitionTime) {

        const $imageEffectContainer = $('.image-question-Effect');
        $imageEffectContainer.removeClass('d-none');
        $imageEffectContainer.empty();
        if (gridSize === 0) {
            return;
        }
        const totalItems = gridSize * gridSize;

        const revealOrder = revealSequences[totalItems];

        const delayPerItem = totalTransitionTime / totalItems;

        const gridItems = [];
        for (let i = 0; i < totalItems; i++) {
            const $gridItem = $('<div></div>')
                .addClass(`GridRevealWrapper-item item-${gridSize}_${gridSize}`)
                .css({
                    'background-color': '#24459b',
                    'outline': 'none'
                });

            gridItems.push($gridItem);
            $imageEffectContainer.append($gridItem);
        }

        revealOrder.forEach((index, i) => {
            setTimeout(() => {
                gridItems[index].css('background-color', 'transparent');
            }, i * delayPerItem);
        });
    }
    function startCountdown(elementSelector, duration) {
        let $countdownElement = $(elementSelector);

        let countdownValue = duration;

        $countdownElement.text(countdownValue);

        let countdownInterval = setInterval(function () {
            countdownValue--;
            $countdownElement.text(countdownValue);

            if (countdownValue <= 0) {
                clearInterval(countdownInterval);
            }
        }, 1000);
    }
    function getDefaultTitle(type) {
        switch (type) {
            case 'quiz':
                return 'Câu đố';
            case 'true_false':
                return 'Đúng hay sai';
            case 'input_answer':
                return 'Nhập đáp án';
            default:
                return 'Câu đố';
        }
    }
    function getDefaultIcon(type) {
        switch (type) {
            case 'quiz':
                return '/src/img/logo-quiz.png';
            case 'true_false':
                return '/src/img/logo-true_false.png';
            case 'input_answer':
                return '/src/img/logo-type-quiz.png';
            default:
                return '/src/img/logo-quiz.png';
        }
    }
    function shuffleArray(array) {
        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]]; 
        }
        return array;
    }
    connection.on("StartCountdown", function (exists) {
        if (exists) { 
            $(".instructions-with-avatar__PageMainContent").remove();
            $(".quiz__PageWrapper").remove();
            $(".bottom-bar__BottomBar").remove();
            const startTime = new Date().getTime();
            sessionStorage.setItem('startTime', startTime);
            RenderQuestion();
        }
    });
    function RenderQuestion(timeCountDown = null) {
        // Lấy dữ liệu từ sessionStorage
        const storedData = JSON.parse(sessionStorage.getItem('question-player-params'));
        let scores = parseInt(sessionStorage.getItem("scores")) || 0;
        // Gán lại cho questionCurrent
        const questionCurrent = storedData.question;
        let choices = questionCurrent.choices;
        if (storedData.quizOption.isRandomAnswer && questionCurrent.typeQuestion !== "true_false") {
            choices = shuffleArray(choices);
        }
        const checkImg = questionCurrent.image && questionCurrent.image !== "" ? `<div class="question-media__QuestionImage">
                                                                <img class="question-base__Img" src="${questionCurrent.image}" />
                                                            <div class="image-question-Effect"></div>
                                                                </div> `: "";
        const checkImgEffect = questionCurrent.imageEffect && questionCurrent.imageEffect !== "0" && questionCurrent.imageEffect !== "";
        const checkIsShowAvatar = storedData.quizOption.isShowAvatar == true ? `<div class="styles__AvatarWrapper" style="width:80px;height:80px;margin-bottom:15px;">
                                                               <img class="styles__AvatarItem" src="${itemcurrent}" />
                                                        <img class="styles__AvatarBase" src="${avatarcurrent}" />
                                                    <div class="styles__AvatarFace">
                                                        <img src="/src/img/eyes-blink.gif" />
                                                    </div>
                                                </div>` : "";
        $(".question-results__PageWrapper").remove();
        if (storedData.quizOption.isShowQAndA == true) {
            if (questionCurrent.typeQuestion != "input_answer") {
                $(".instructions__PageWrapper").append(`<main class="question-results__PageWrapper">
                                            <div class="top-bar__TopBar">
                                                <div class="top-bar__TitleWrapper">
                                                    <section class="top-bar__Title">
                                                        <div class="question-title__TitleWrapper">
                                                            <span class="question-title__Title">${questionCurrent.questionText}</span>
                                                        </div>
                                                    </section>
                                                </div>
                                            </div>
                                            <header class="styles__TopContent">
                                                <div class="countdown__CountdownWrapper">
                                                <div class="question-countdown__count"></div>
                                                </div>
                                                <div class="question-media__QuestionMedia">
                                                    <div class="question-image__ImageWrapper">
                                                        <div class="question-image__MediaImageWrapper">
                                                           ${checkImg}
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="quiz-question__RightContent">
                                                    <div class="answer-counter__AnswerCounter">
                                                        ${questionCurrent.typeAnswer === 2 ? `<button class="submit-answer" onclick="submitAnswerChoose(${questionCurrent.id})">Nộp đáp án</button>` : ""}
                                                    </div>
                                                </div>
                                            </header>
                                            <div class="question-results__QuestionChoices">
                                                    ${choices.map(choice => {
                    // Sự kiện `onclick` động cho từng câu trả lời
                    const isChooseAnswer = questionCurrent.typeAnswer === 1
                        ? `SubmitAnswer(${choice.id}, ${questionCurrent.id})`
                        : `chooseAnswer(${choice.id})`;

                    return `
                         <button class="card__PassiveCardChoice choice-item" onclick="${isChooseAnswer}">
                             ${questionCurrent.typeAnswer === 2 ? `
                                 <div class="choice__CornerCheck">
                                      <span class="icon__Icon">
                                           <svg style="margin: 4px auto;" viewBox="0 0 32 32" aria-hidden="true">
                                                <path d="M21.9659268,7.29355403 L13.4414162,16.6716376 L9.95856573,13.6333101 L6.28048804,17.3134693 L13.6554761,24.1926221 L25.8261396,10.805116 L21.9659268,7.29355403 Z" style="fill: #fff;"></path>
                                           </svg>
                                      </span>
                                 </div>` : ""}
                                 <div class="card-icon__IconWrapper">
                                      <span class="icon__Icon" style="width: 5.95733vmin; height: 5.95733vmin;">
                                           <svg viewBox="0 0 32 32" aria-hidden="true">
                                                <path d="M4,16.0038341 L16,4 L28,16.0007668 L16,28 L4,16.0038341 Z" style="fill: inherit;"></path>
                                           </svg>
                                      </span>
                                 </div>
                                 <span class="question-choice-content__Text">
                                       <span class="break-long-words__WordBreak">${choice.answer}</span>
                                 </span>
                            </button>
                         `;
                }).join('')}
                        </div>
                              <div class="bottom-bar__BottomBar">
                                  ${checkIsShowAvatar}
                                  <div class="bottom-bar__NameWrapper">
                                       <span class="bottom-bar__NicknameSection">@ViewBag.Player.Nickname</span>
                                  </div>
                                  <div class="bottom-bar-score">${scores}</div>
                             </div>
                         </main>`);
            } else {
                $(".instructions__PageWrapper").append(`<main class="question-results__PageWrapper">
                                                <div class="top-bar__TopBar">
                                                    <div class="top-bar__TitleWrapper">
                                                        <section class="top-bar__Title">
                                                            <div class="question-title__TitleWrapper">
                                                                <span class="question-title__Title">${questionCurrent.questionText}</span>
                                                            </div>
                                                        </section>
                                                    </div>
                                                </div>
                                                <header class="styles__TopContent">
                                                    <div class="countdown__CountdownWrapper">
                                                    <div class="question-countdown__count"></div>
                                                    </div>
                                                    <div class="question-media__QuestionMedia">
                                                        <div class="question-image__ImageWrapper">
                                                            <div class="question-image__MediaImageWrapper">
                                                               ${checkImg}
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="quiz-question__RightContent">
                                                        <div class="answer-counter__AnswerCounter">
                                                        </div>
                                                    </div>
                                                </header>
                                        <div class="question-results__QuestionChoices" style="align-items:center;flex-direction:column;">
                                            <div class="card-answer" id="anwer-input" contenteditable="true" data-placeholder="Nhập đáp án..."></div>
                                            <button class="submit-answer" style="max-width:100px" onclick="submitInputAnswer(${questionCurrent.id})">Nộp đáp án</button>
                                    </div>
                                  <div class="bottom-bar__BottomBar">
                                      ${checkIsShowAvatar}
                                      <div class="bottom-bar__NameWrapper">
                                           <span class="bottom-bar__NicknameSection">@ViewBag.Player.Nickname</span>
                                      </div>
                                      <div class="bottom-bar-score">${scores}</div>
                                 </div>
                             </main>`);
            }
            checkImgEffect == true ? applyGridRevealEffect(parseInt(questionCurrent.imageEffect), questionCurrent.time * 1000) : "";
        } else {
            if (questionCurrent.typeQuestion != "input_answer") {
                $(".instructions__PageWrapper").append(`<main class="question-results__PageWrapper">
                                                <header class="styles__TopContent">
                                                    <div class="countdown__CountdownWrapper">
                                                    <div class="question-countdown__count"></div>
                                                    </div>
                                                    <div class="question-media__QuestionMedia">
                                                        <div class="question-image__ImageWrapper">
                                                            <div class="question-image__MediaImageWrapper">
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="quiz-question__RightContent">
                                                        <div class="answer-counter__AnswerCounter">
                                                            ${questionCurrent.typeAnswer === 2 ? `<button class="submit-answer" onclick="submitAnswerChoose(${questionCurrent.id})">Nộp đáp án</button>` : ""}
                                                        </div>
                                                    </div>
                                                </header>
                                                <div class="question-results__QuestionChoices">
                    ${choices.map(choice => {
                    // Sự kiện `onclick` động cho từng câu trả lời
                    const isChooseAnswer = questionCurrent.typeAnswer === 1
                        ? `SubmitAnswer(${choice.id}, ${questionCurrent.id})`
                        : `chooseAnswer(${choice.id})`;

                    return `
                             <button class="card__PassiveCardChoice choice-item" onclick="${isChooseAnswer}">
                                 ${questionCurrent.typeAnswer === 2 ? `
                                     <div class="choice__CornerCheck">
                                          <span class="icon__Icon">
                                               <svg style="margin: 4px auto;" viewBox="0 0 32 32" aria-hidden="true">
                                                    <path d="M21.9659268,7.29355403 L13.4414162,16.6716376 L9.95856573,13.6333101 L6.28048804,17.3134693 L13.6554761,24.1926221 L25.8261396,10.805116 L21.9659268,7.29355403 Z" style="fill: #fff;"></path>
                                               </svg>
                                          </span>
                                     </div>` : ""}
                                     <div class="card-icon__IconWrapper">
                                          <span class="icon__Icon" style="width: 5.95733vmin; height: 5.95733vmin;">
                                               <svg viewBox="0 0 32 32" aria-hidden="true">
                                                    <path d="M4,16.0038341 L16,4 L28,16.0007668 L16,28 L4,16.0038341 Z" style="fill: inherit;"></path>
                                               </svg>
                                          </span>
                                     </div>
                                     <span class="question-choice-content__Text">
                                           <span class="break-long-words__WordBreak">${choice.answer}</span>
                                     </span>
                                </button>
                             `;
                }).join('')}
                            </div>
                                  <div class="bottom-bar__BottomBar">
                                      ${checkIsShowAvatar}
                                      <div class="bottom-bar__NameWrapper">
                                           <span class="bottom-bar__NicknameSection">@ViewBag.Player.Nickname</span>
                                      </div>
                                      <div class="bottom-bar-score">${scores}</div>
                                 </div>
                             </main>`);
            } else {
                $(".instructions__PageWrapper").append(`<main class="question-results__PageWrapper">
                                                    <header class="styles__TopContent">
                                                        <div class="countdown__CountdownWrapper">
                                                        <div class="question-countdown__count"></div>
                                                        </div>
                                                        <div class="question-media__QuestionMedia">
                                                            <div class="question-image__ImageWrapper">
                                                                <div class="question-image__MediaImageWrapper">
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="quiz-question__RightContent">
                                                            <div class="answer-counter__AnswerCounter">
                                                            </div>
                                                        </div>
                                                    </header>
                                            <div class="question-results__QuestionChoices" style="align-items:center;flex-direction:column;">
                                                <div class="card-answer" id="anwer-input" contenteditable="true" data-placeholder="Nhập đáp án..."></div>
                                                <button class="submit-answer" style="max-width:100px" onclick="submitInputAnswer(${questionCurrent.id})">Nộp đáp án</button>
                                        </div>
                                      <div class="bottom-bar__BottomBar">
                                          ${checkIsShowAvatar}
                                          <div class="bottom-bar__NameWrapper">
                                               <span class="bottom-bar__NicknameSection">@ViewBag.Player.Nickname</span>
                                          </div>
                                          <div class="bottom-bar-score">${scores}</div>
                                     </div>
                                 </main>`);
            }
        }
        startCountdown('.question-countdown__count', timeCountDown ?? questionCurrent.time);
    }
    function chooseAnswer(value) {
        const $button = $(`button[onclick="chooseAnswer(${value})"]`);
        if ($button.hasClass("choose")) {
            $button.removeClass("choose");
            arranswer = arranswer.filter(item => item !== value);
        } else {
            $button.addClass("choose");
            arranswer.push(value);
        }
    }
    function submitInputAnswer(quesionId) {
        const currentTime = new Date().getTime();
        const startTime = parseInt(sessionStorage.getItem('startTime'), 10);
        const timeTaken = (currentTime - startTime) / 1000;
        const answerText = $("#anwer-input").text();
        // Gửi tất cả các đáp án
        connection.invoke("SubmitInputAnswer", parseInt(playerid, 10), answerText, quesionId, pin, timeTaken)
            .catch(function (err) {
                console.error(err.toString());
            });
        clearAnswer();
    }
    function submitAnswerChoose(quesionId) {
        const currentTime = new Date().getTime();
        const startTime = parseInt(sessionStorage.getItem('startTime'), 10);
        const timeTaken = (currentTime - startTime) / 1000;

        // Gửi tất cả các đáp án
        connection.invoke("SubmitMultiAnswer", parseInt(playerid, 10), arranswer, quesionId, pin, timeTaken)
            .catch(function (err) {
                console.error(err.toString());
            });
        arranswer = [];
        clearAnswer();
    }
    function SubmitAnswer(choiceId, quesionId) {
        const currentTime = new Date().getTime();
        // Lấy thời gian bắt đầu từ sessionStorage
        const startTime = parseInt(sessionStorage.getItem('startTime'), 10);
        
        // Tính toán thời gian đã trôi qua (đơn vị là giây)
        const timeTaken = (currentTime - startTime) / 1000;
        connection.invoke("SubmitAnswer", parseInt(playerid, 10), choiceId, quesionId, pin, timeTaken)
            .catch(function (err) {
                console.error(err.toString());
            });
        clearAnswer();
    }
    function clearAnswer() {
        let scores = parseInt(sessionStorage.getItem("scores")) || 0;
        const storedData = JSON.parse(sessionStorage.getItem('question-player-params'));
        const checkIsShowAvatar = storedData.quizOption.isShowAvatar == true ? `<div class="styles__AvatarWrapper" style="width:80px;height:80px;margin-bottom:15px;">
                                                          <img class="styles__AvatarItem" src="${itemcurrent}" />
                                                        <img class="styles__AvatarBase" src="${avatarcurrent}" />
                                                        <div class="styles__AvatarFace">
                                                            <img src="/src/img/eyes-blink.gif" />
                                                        </div>
                                                    </div>` : "";
        $(".question-results__PageWrapper").remove();
        $(".instructions__PageWrapper").append(`<main class="instructions-with-avatar__PageMainContent">
                <div class="instructions-with-avatar__TextContent">
                        <h1 class="header-text__HeaderText">
                            <span class="shadow-text__Container">
                                <span class="shadow-text__HiddenText">Nhanh như chớp!</span>
                                <span class="shadow-text__Text">Nhanh như chớp!</span>
                                <span class="shadow-text__Shadow">Nhanh như chớp!</span>
                            </span>
                        </h1>
                        <div class="spinner__Container">
                            <svg id="Layer_Loader" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 140 140" enable-background="new 0 0 140 140" xml:space="preserve" color="#fff" aria-label="Merci de patienter" data-functional-selector="spinner" class="spinner__Spinner-sc-r6rcac-1 civXet"><g><circle opacity="0" fill="#FFFFFF" cx="70" cy="70" r="70"></circle><g><path fill="#FFFFFF" d="M70,0C31.3,0,0,31.3,0,70h35c0-19.3,15.7-35,35-35s35,15.7,35,35h35C140,31.3,108.7,0,70,0z"></path></g></g></svg>
                        </div>
                        <h2 class="sub-header-text__SubHeaderText">
                            <span class="shadow-text__Container">
                                <span class="shadow-text__HiddenText">Chờ những người chơi khác.</span>
                                <span class="shadow-text__Text">Chờ những người chơi khác.</span>
                                <span class="shadow-text__Shadow">Chờ những người chơi khác.</span>
                            </span>
                        </h2>
                    </div>
            </main>
             <div class="bottom-bar__BottomBar">
                                            ${checkIsShowAvatar}
                                            <div class="bottom-bar__NameWrapper">
                                                <span class="bottom-bar__NicknameSection">@ViewBag.Player.Nickname</span>
                                            </div>
                                                <div class="bottom-bar-score">${scores}</div>
                                        </div>`
        );
    }
    connection.on("SendQuestion", function (quizOption, question) {
        // Lấy dữ liệu hiện có từ sessionStorage
        const storedData = JSON.parse(sessionStorage.getItem('question-player-params')) || { quizOption: {}, question: {}, currentQuestionIndex: 0 };
        // Tăng chỉ số câu hỏi hiện tại
        storedData.currentQuestionIndex += 1; // Tăng chỉ số câu hỏi
        // Cập nhật dữ liệu
        storedData.quizOption = quizOption;
        storedData.question = question;
        // Lưu lại vào sessionStorage
        sessionStorage.setItem('question-player-params', JSON.stringify(storedData));
      
        const scores = parseInt(sessionStorage.getItem("scores")) || 0;
        const checkIsShowAvatar = quizOption.isShowAvatar == true ? `<div class="styles__AvatarWrapper" style="width:80px;height:80px;margin-bottom:15px;">
                                                    <img class="styles__AvatarItem" src="${itemcurrent}" />
                                                    <img class="styles__AvatarBase" src="${avatarcurrent}" />
                                                    <div class="styles__AvatarFace">
                                                        <img src="/src/img/eyes-blink.gif" />
                                                    </div>
                                                </div>` : "";
        $(".bottom-bar__BottomBar").remove();
        $(".instructions-with-avatar__PageMainContent").remove();
        if (!quizOption.isShowQAndA || storedData.currentQuestionIndex == 1) {
            $(".instructions__PageWrapper").append(`
                    <main class="instructions-with-avatar__PageMainContent">
                <div class="instructions-with-avatar__TextContent">
                        <h1 class="header-text__HeaderText">
                            <span class="shadow-text__Container">
                                <span class="shadow-text__HiddenText">Chuẩn bị!</span>
                                <span class="shadow-text__Text">Chuẩn bị!</span>
                                <span class="shadow-text__Shadow">Chuẩn bị!</span>
                            </span>
                        </h1>
                        <div class="spinner__Container">
                            <svg id="Layer_Loader" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 140 140" enable-background="new 0 0 140 140" xml:space="preserve" color="#fff" aria-label="Merci de patienter" data-functional-selector="spinner" class="spinner__Spinner-sc-r6rcac-1 civXet"><g><circle opacity="0" fill="#FFFFFF" cx="70" cy="70" r="70"></circle><g><path fill="#FFFFFF" d="M70,0C31.3,0,0,31.3,0,70h35c0-19.3,15.7-35,35-35s35,15.7,35,35h35C140,31.3,108.7,0,70,0z"></path></g></g></svg>
                        </div>
                        <h2 class="sub-header-text__SubHeaderText">
                            <span class="shadow-text__Container">
                                <span class="shadow-text__HiddenText">Đang tải...</span>
                                <span class="shadow-text__Text">Đang tải...</span>
                                <span class="shadow-text__Shadow">Đang tải...</span>
                            </span>
                        </h2>
                    </div>
                  </main>
                  <div class="bottom-bar__BottomBar">
                                                    ${checkIsShowAvatar}
                                                    <div class="bottom-bar__NameWrapper">
                                                        <span class="bottom-bar__NicknameSection">@ViewBag.Player.Nickname</span>
                                                    </div>
                                                    <div class="bottom-bar-score">${scores}</div>
                                                </div>
                `);
        }
        if (quizOption.isShowQAndA == true) {
            setTimeout(() => {
                $(".instructions-with-avatar__PageMainContent").remove();
                $(".bottom-bar__BottomBar").remove();
                $(".instructions__PageWrapper").append(`
                        <main class="quiz__PageWrapper">
                            <main class="styles__PageWrapper">
                                <div class="styles__QuestionIntroWrapper">
                                    <div class="question-intro__QuestionCount">
                                        ${storedData.currentQuestionIndex} trên ${quizOption.questionLength}
                                    </div>
                                    <div class="styles__QuestionContainer">
                                        <div class="styles__AnimationContainer">
                                            <div class="styles__Animation">
                                                <div class="styles__AnimationImgWrapper">
                                                    <div class="styles__AnimationImgBlock">
                                                         <img class="styles__AnimationImg" src="${getDefaultIcon(question.typeQuestion)}" />
                                                    </div>
                                                    <div class="styles__WrapperBlock">${getDefaultTitle(question.typeQuestion)}</div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="block-title__Container styles_BlockTitle">
                                            <div class="block-title__Wrapper">
                                                    <h1 class="block-title__Title">${question.questionText}</h1>
                                            </div>
                                        </div>
                                        <div class="styles__LoadingWrapper">
                                            <div class="loading-bar__Bar">
                                                <div class="loading-bar__ProgressMeter"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </main>
                        </main>
                            <div class="bottom-bar__BottomBar">
                                                    ${checkIsShowAvatar}
                                                    <div class="bottom-bar__NameWrapper">
                                                        <span class="bottom-bar__NicknameSection">@ViewBag.Player.Nickname</span>
                                                    </div>
                                                    <div class="bottom-bar-score">${scores}</div>
                                                </div>
                        `);
            }, storedData.currentQuestionIndex == 1 ? 7500 : 0)
        }
    });

    connection.on("RoomNotFound", function (exists) {
        if (exists) {
            isKicked = true;
            sessionStorage.removeItem('question-player-params');
            sessionStorage.removeItem('isLoaded');
            window.location.href = `/pin`;
        }
    });
    connection.on("RoomDelete", function (exists) {
        if (exists) {
            isKicked = true;
            sessionStorage.removeItem('question-player-params');
            sessionStorage.removeItem('isLoaded');
            window.location.href = `/pin`;
        }
    });
    connection.on("PlayerOut", function (exists,playercurrent) {
        if (exists) {
            isKicked = true;
            if (parseInt(playerid, 10) === playercurrent){
                sessionStorage.removeItem('question-player-params');
                sessionStorage.removeItem('isLoaded');
                window.location.href = `/pin`;
            }
        }
    });

    $(document).on('click', '#avatar-current', function () {
        $(this).addClass("active");
        $(".avatar-content__AvatarMenu").addClass("open");
    });

    $(document).on('click', '#close-menu', function () {
        $("#avatar-current").removeClass("active");
        $(".avatar-content__AvatarMenu").removeClass("open");
        changeAvartar(); 
    });

    $(document).on('click', '.avatar-content__AvatarStyleTab', function () {
        $(".avatar-content__AvatarStyleTab").removeClass("active");
        $(this).addClass("active");
        const value = $(this).attr("data-menu");
        $(".avatar-content__AvatarMenuContent").hide();
        $(`#${value}`).show();
    });

    $(document).on('click', '.avatar-content__SelectionButton', function () {
        if ($(this).hasClass("accessory")) {
            $(".avatar-content__SelectionButton.accessory").removeClass("focus");
            $(this).addClass("focus");
            var urlimg = $(this).find(".styles__AvatarItem").attr("src");
            $("#avatar-current .styles__AvatarItem").attr("src", urlimg);
        } else {
            $(".avatar-content__SelectionButton:not(.accessory)").removeClass("focus");
            $(this).addClass("focus");
            var urlimg = $(this).find(".styles__AvatarBase").attr("src");
            $("#avatar-current .styles__AvatarBase").attr("src", urlimg);
        }
    });
    function OptionAvatar(value) {
        if (value) {
            $(".instructions-with-avatar__TextContent").remove();
            $(".bottom-bar__BottomBar").remove();
            $(".instructions-with-avatar__PageMainContent").append(`<button id="avatar-current" class="avatar-content__AvatarContainer" style="--scale-size: -225.25px;">
                <div class="avatar-content__EditButton">
                    <span class="icon__Icon">
                        <svg viewBox="0 0 32 32" focusable="false" stroke="none" stroke-width="0" aria-hidden="true"><title>Icon</title><path d="M23.4091683,8.594 C24.1731683,9.359 24.1731683,10.693 23.4091683,11.458 L22.6901683,12.178 L19.8241683,9.313 L20.5451683,8.594 C21.3101683,7.83 22.6441683,7.829 23.4091683,8.594 L23.4091683,8.594 Z M8.37616832,23.626 L8.97116832,21.252 L10.7501683,23.033 L8.37616832,23.626 Z M18.4111683,10.728 L21.2741683,13.591 L12.7061683,22.159 L9.84316832,19.296 L18.4111683,10.728 Z M24.8211683,7.179 C24.0611683,6.418 23.0501683,6 21.9741683,6 C20.9001683,6 19.8881683,6.418 19.1281683,7.179 L7.71916832,18.587 C7.71916832,18.587 7.71816832,18.59 7.71716832,18.591 C7.63616832,18.673 7.49716832,18.889 7.45616832,19.052 L6.03016832,24.757 C5.94416832,25.097 6.04516832,25.458 6.29316832,25.706 L6.29416832,25.707 L6.29616832,25.708 C6.54416832,25.956 6.90416832,26.057 7.24516832,25.972 L12.9491683,24.545 C13.1121683,24.504 13.3291683,24.365 13.4101683,24.284 C13.4111683,24.283 13.4141683,24.282 13.4141683,24.282 L24.8231683,12.873 C25.5831683,12.113 26.0021683,11.102 26.0011683,10.027 C26.0011683,8.951 25.5831683,7.941 24.8231683,7.18 L24.8211683,7.179 Z" style="fill: rgb(0, 0, 0);"></path></svg>
                    </span>
                </div>
                <div class="avatar-content__Container">
                    <div class="styles__AvatarWrapper av-animation" style="width:100%;height:100%">
                        <img class="styles__AvatarItem" src="${itemcurrent}" />
                        <img class="styles__AvatarBase" src="${avatarcurrent}" />
                        <div class="styles__AvatarFace">
                            <img src="/src/img/eyes-blink.gif" />
                        </div>
                    </div>
                </div>
            </button>
            <div class="avatar-content__AvatarMenuContainer">
                <div class="avatar-content__AvatarMenu">
                    <div class="avatar-content__AvatarStyleTabs">
                        <button class="avatar-content__AvatarStyleTab active" data-menu="avatar">
                            Nhân vật
                        </button>
                        <button class="avatar-content__AvatarStyleTab" data-menu="accessory">
                            Phụ kiện
                        </button>
                    </div>
                    <div class="avatar-content__AvatarMenuContentContainer" >
                        <div id="avatar" class="avatar-content__AvatarMenuContent">
                            <button class="avatar-content__SelectionButton">
                                <div class="styles__AvatarWrapper" style="width:100%;height:100%">
                                    <img class="styles__AvatarBase" src="/src/img/avatar/avatar1.svg" />
                                </div>
                                <div class="styles__StaticFace">
                                    <svg xmlns="http://www.w3.org/2000/svg" id="Assets" viewBox="0 0 800 800">
                                        <defs>
                                        </defs>
                                        <circle cx="523.68" cy="455.68" r="59.36" style="fill:rgb(255, 255, 255)"></circle>
                                        <circle cx="517.97" cy="461.36" r="69.39" style="fill:rgb(255, 255, 255)"></circle>
                                        <circle cx="506.57" cy="461.36" r="33.28" class="right_eye_pupil_color"></circle>
                                        <circle cx="276.32" cy="455.68" r="59.36" style="fill:rgb(255, 255, 255)"></circle>
                                        <circle cx="282.03" cy="461.36" r="69.39" style="fill:rgb(255, 255, 255)"></circle>
                                        <circle cx="293.43" cy="461.36" r="33.28" class="right_eye_pupil_color"></circle>
                                        <path d="M482,652.73c.7-.29,1.2.85.62,1.41-7,6.75-29.55,23.08-82.65,23.08s-75.61-16.33-82.65-23.08c-.58-.56-.08-1.7.62-1.41,9.18,3.85,37.66,14,82,14S472.85,656.58,482,652.73Z" ></path>
                                    </svg>
                                </div>
                            </button>
                            <button class="avatar-content__SelectionButton">
                                <div class="styles__AvatarWrapper" style="width:100%;height:100%">
                                    <img class="styles__AvatarBase" src="/src/img/avatar/avatar2.svg" />
                                </div>
                                <div class="styles__StaticFace">
                                    <svg xmlns="http://www.w3.org/2000/svg" id="Assets" viewBox="0 0 800 800">
                                        <defs>
                                        </defs>
                                        <circle cx="523.68" cy="455.68" r="59.36" style="fill:rgb(255, 255, 255)"></circle>
                                        <circle cx="517.97" cy="461.36" r="69.39" style="fill:rgb(255, 255, 255)"></circle>
                                        <circle cx="506.57" cy="461.36" r="33.28" class="right_eye_pupil_color"></circle>
                                        <circle cx="276.32" cy="455.68" r="59.36" style="fill:rgb(255, 255, 255)"></circle>
                                        <circle cx="282.03" cy="461.36" r="69.39" style="fill:rgb(255, 255, 255)"></circle>
                                        <circle cx="293.43" cy="461.36" r="33.28" class="right_eye_pupil_color"></circle>
                                        <path d="M482,652.73c.7-.29,1.2.85.62,1.41-7,6.75-29.55,23.08-82.65,23.08s-75.61-16.33-82.65-23.08c-.58-.56-.08-1.7.62-1.41,9.18,3.85,37.66,14,82,14S472.85,656.58,482,652.73Z" class="lip_color"></path>
                                    </svg>
                                </div>
                            </button>
                            <button class="avatar-content__SelectionButton">
                                <div class="styles__AvatarWrapper" style="width:100%;height:100%">
                                    <img class="styles__AvatarBase" src="/src/img/avatar/avatar3.svg" />
                                </div>
                                <div class="styles__StaticFace">
                                    <svg xmlns="http://www.w3.org/2000/svg" id="Assets" viewBox="0 0 800 800">
                                        <defs>
                                        </defs>
                                        <circle cx="523.68" cy="455.68" r="59.36" style="fill:rgb(255, 255, 255)"></circle>
                                        <circle cx="517.97" cy="461.36" r="69.39" style="fill:rgb(255, 255, 255)"></circle>
                                        <circle cx="506.57" cy="461.36" r="33.28" class="right_eye_pupil_color"></circle>
                                        <circle cx="276.32" cy="455.68" r="59.36" style="fill:rgb(255, 255, 255)"></circle>
                                        <circle cx="282.03" cy="461.36" r="69.39" style="fill:rgb(255, 255, 255)"></circle>
                                        <circle cx="293.43" cy="461.36" r="33.28" class="right_eye_pupil_color"></circle>
                                        <path d="M482,652.73c.7-.29,1.2.85.62,1.41-7,6.75-29.55,23.08-82.65,23.08s-75.61-16.33-82.65-23.08c-.58-.56-.08-1.7.62-1.41,9.18,3.85,37.66,14,82,14S472.85,656.58,482,652.73Z" class="lip_color"></path>
                                    </svg>
                                </div>
                            </button>
                            <button class="avatar-content__SelectionButton">
                                <div class="styles__AvatarWrapper" style="width:100%;height:100%">
                                    <img class="styles__AvatarBase" src="/src/img/avatar/avatar4.svg" />
                                </div>
                                <div class="styles__StaticFace">
                                    <svg xmlns="http://www.w3.org/2000/svg" id="Assets" viewBox="0 0 800 800">
                                        <defs>
                                        </defs>
                                        <circle cx="523.68" cy="455.68" r="59.36" style="fill:rgb(255, 255, 255)"></circle>
                                        <circle cx="517.97" cy="461.36" r="69.39" style="fill:rgb(255, 255, 255)"></circle>
                                        <circle cx="506.57" cy="461.36" r="33.28" class="right_eye_pupil_color"></circle>
                                        <circle cx="276.32" cy="455.68" r="59.36" style="fill:rgb(255, 255, 255)"></circle>
                                        <circle cx="282.03" cy="461.36" r="69.39" style="fill:rgb(255, 255, 255)"></circle>
                                        <circle cx="293.43" cy="461.36" r="33.28" class="right_eye_pupil_color"></circle>
                                        <path d="M482,652.73c.7-.29,1.2.85.62,1.41-7,6.75-29.55,23.08-82.65,23.08s-75.61-16.33-82.65-23.08c-.58-.56-.08-1.7.62-1.41,9.18,3.85,37.66,14,82,14S472.85,656.58,482,652.73Z"></path>
                                    </svg>
                                </div>
                            </button>
                            <button class="avatar-content__SelectionButton">
                                <div class="styles__AvatarWrapper" style="width:100%;height:100%">
                                    <img class="styles__AvatarBase" src="/src/img/avatar/avatar5.svg" />
                                </div>
                                <div class="styles__StaticFace">
                                    <svg xmlns="http://www.w3.org/2000/svg" id="Assets" viewBox="0 0 800 800">
                                        <defs>
                                        </defs>
                                        <circle cx="523.68" cy="455.68" r="59.36" style="fill:rgb(255, 255, 255)"></circle>
                                        <circle cx="517.97" cy="461.36" r="69.39" style="fill:rgb(255, 255, 255)"></circle>
                                        <circle cx="506.57" cy="461.36" r="33.28" class="right_eye_pupil_color"></circle>
                                        <circle cx="276.32" cy="455.68" r="59.36" style="fill:rgb(255, 255, 255)"></circle>
                                        <circle cx="282.03" cy="461.36" r="69.39" style="fill:rgb(255, 255, 255)"></circle>
                                        <circle cx="293.43" cy="461.36" r="33.28" class="right_eye_pupil_color"></circle>
                                        <path d="M482,652.73c.7-.29,1.2.85.62,1.41-7,6.75-29.55,23.08-82.65,23.08s-75.61-16.33-82.65-23.08c-.58-.56-.08-1.7.62-1.41,9.18,3.85,37.66,14,82,14S472.85,656.58,482,652.73Z" class="lip_color"></path>
                                    </svg>
                                </div>
                            </button>
                            <button class="avatar-content__SelectionButton">
                                <div class="styles__AvatarWrapper" style="width:100%;height:100%">
                                    <img class="styles__AvatarBase" src="/src/img/avatar/avatar6.svg" />
                                </div>
                                <div class="styles__StaticFace">
                                    <svg xmlns="http://www.w3.org/2000/svg" id="Assets" viewBox="0 0 800 800">
                                        <defs>
                                        </defs>
                                        <circle cx="523.68" cy="455.68" r="59.36" style="fill:rgb(255, 255, 255)"></circle>
                                        <circle cx="517.97" cy="461.36" r="69.39" style="fill:rgb(255, 255, 255)"></circle>
                                        <circle cx="506.57" cy="461.36" r="33.28" class="right_eye_pupil_color"></circle>
                                        <circle cx="276.32" cy="455.68" r="59.36" style="fill:rgb(255, 255, 255)"></circle>
                                        <circle cx="282.03" cy="461.36" r="69.39" style="fill:rgb(255, 255, 255)"></circle>
                                        <circle cx="293.43" cy="461.36" r="33.28" class="right_eye_pupil_color"></circle>
                                        <path d="M482,652.73c.7-.29,1.2.85.62,1.41-7,6.75-29.55,23.08-82.65,23.08s-75.61-16.33-82.65-23.08c-.58-.56-.08-1.7.62-1.41,9.18,3.85,37.66,14,82,14S472.85,656.58,482,652.73Z" class="lip_color"></path>
                                    </svg>
                                </div>
                            </button>
                            <button class="avatar-content__SelectionButton">
                                <div class="styles__AvatarWrapper" style="width:100%;height:100%">
                                    <img class="styles__AvatarBase" src="/src/img/avatar/avatar7.svg" />
                                </div>
                                <div class="styles__StaticFace">
                                    <svg xmlns="http://www.w3.org/2000/svg" id="Assets" viewBox="0 0 800 800">
                                        <defs>
                                        </defs>
                                        <circle cx="523.68" cy="455.68" r="59.36" style="fill:rgb(255, 255, 255)"></circle>
                                        <circle cx="517.97" cy="461.36" r="69.39" style="fill:rgb(255, 255, 255)"></circle>
                                        <circle cx="506.57" cy="461.36" r="33.28" class="right_eye_pupil_color"></circle>
                                        <circle cx="276.32" cy="455.68" r="59.36" style="fill:rgb(255, 255, 255)"></circle>
                                        <circle cx="282.03" cy="461.36" r="69.39" style="fill:rgb(255, 255, 255)"></circle>
                                        <circle cx="293.43" cy="461.36" r="33.28" class="right_eye_pupil_color"></circle>
                                        <path d="M482,652.73c.7-.29,1.2.85.62,1.41-7,6.75-29.55,23.08-82.65,23.08s-75.61-16.33-82.65-23.08c-.58-.56-.08-1.7.62-1.41,9.18,3.85,37.66,14,82,14S472.85,656.58,482,652.73Z" class="lip_color"></path>
                                    </svg>
                                </div>
                            </button>
                            <button class="avatar-content__SelectionButton">
                                <div class="styles__AvatarWrapper" style="width:100%;height:100%">
                                    <img class="styles__AvatarBase" src="/src/img/avatar/avatar8.svg" />
                                </div>
                                <div class="styles__StaticFace">
                                    <svg xmlns="http://www.w3.org/2000/svg" id="Assets" viewBox="0 0 800 800">
                                        <defs>
                                        </defs>
                                        <circle cx="523.68" cy="455.68" r="59.36" style="fill:rgb(255, 255, 255)"></circle>
                                        <circle cx="517.97" cy="461.36" r="69.39" style="fill:rgb(255, 255, 255)"></circle>
                                        <circle cx="506.57" cy="461.36" r="33.28" class="right_eye_pupil_color"></circle>
                                        <circle cx="276.32" cy="455.68" r="59.36" style="fill:rgb(255, 255, 255)"></circle>
                                        <circle cx="282.03" cy="461.36" r="69.39" style="fill:rgb(255, 255, 255)"></circle>
                                        <circle cx="293.43" cy="461.36" r="33.28" class="right_eye_pupil_color"></circle>
                                        <path d="M482,652.73c.7-.29,1.2.85.62,1.41-7,6.75-29.55,23.08-82.65,23.08s-75.61-16.33-82.65-23.08c-.58-.56-.08-1.7.62-1.41,9.18,3.85,37.66,14,82,14S472.85,656.58,482,652.73Z" class="lip_color"></path>
                                    </svg>
                                </div>
                            </button>
                        </div>
                        <div id="accessory" class="avatar-content__AvatarMenuContent" style="display:none">
                            <button class="avatar-content__SelectionButton accessory">
                                <div class="styles__AvatarWrapper" style="width:100%;height:100%">
                                    <img class="styles__AvatarItem" src="/src/img/accessory/accessory1.svg" />
                                    <img class="styles__AvatarBase" src="/src/img/avatar/placeholder-avatar.svg" />
                                </div>
                            </button>
                            <button class="avatar-content__SelectionButton accessory">
                                <div class="styles__AvatarWrapper" style="width:100%;height:100%">
                                    <img class="styles__AvatarItem" src="/src/img/accessory/accessory2.svg" />
                                    <img class="styles__AvatarBase" src="/src/img/avatar/placeholder-avatar.svg" />
                                </div>
                            </button>
                            <button class="avatar-content__SelectionButton accessory">
                                <div class="styles__AvatarWrapper" style="width:100%;height:100%">
                                    <img class="styles__AvatarItem" src="/src/img/accessory/accessory3.svg" />
                                    <img class="styles__AvatarBase" src="/src/img/avatar/placeholder-avatar.svg" />
                                </div>
                            </button>
                            <button class="avatar-content__SelectionButton accessory">
                                <div class="styles__AvatarWrapper" style="width:100%;height:100%">
                                    <img class="styles__AvatarItem" src="/src/img/accessory/accessory4.svg" />
                                    <img class="styles__AvatarBase" src="/src/img/avatar/placeholder-avatar.svg" />
                                </div>
                            </button>
                            <button class="avatar-content__SelectionButton accessory">
                                <div class="styles__AvatarWrapper" style="width:100%;height:100%">
                                    <img class="styles__AvatarItem" src="/src/img/accessory/accessory5.svg" />
                                    <img class="styles__AvatarBase" src="/src/img/avatar/placeholder-avatar.svg" />
                                </div>
                            </button>
                            <button class="avatar-content__SelectionButton accessory">
                                <div class="styles__AvatarWrapper" style="width:100%;height:100%">
                                    <img class="styles__AvatarItem" src="/src/img/accessory/accessory6.svg" />
                                    <img class="styles__AvatarBase" src="/src/img/avatar/placeholder-avatar.svg" />
                                </div>
                            </button>
                            <button class="avatar-content__SelectionButton accessory">
                                <div class="styles__AvatarWrapper" style="width:100%;height:100%">
                                    <img class="styles__AvatarItem" src="/src/img/accessory/accessory7.svg" />
                                    <img class="styles__AvatarBase" src="/src/img/avatar/placeholder-avatar.svg" />
                                </div>
                            </button>
                            <button class="avatar-content__SelectionButton accessory">
                                <div class="styles__AvatarWrapper" style="width:100%;height:100%">
                                    <img class="styles__AvatarItem" src="/src/img/accessory/accessory8.svg" />
                                    <img class="styles__AvatarBase" src="/src/img/avatar/placeholder-avatar.svg" />
                                </div>
                            </button>
                            <button class="avatar-content__SelectionButton accessory">
                                <div class="styles__AvatarWrapper" style="width:100%;height:100%">
                                    <img class="styles__AvatarItem" src="/src/img/accessory/accessory9.svg" />
                                    <img class="styles__AvatarBase" src="/src/img/avatar/placeholder-avatar.svg" />
                                </div>
                            </button>
                        </div>
                        <button id="close-menu" class="avatar-content__SelectionDone">Xong</button>
                    </div>
                </div>
            </div>
            <div class="instructions-with-avatar__TextContent">
                <h1 class="header-text__HeaderText">
                    <span class="shadow-text__Container">
                        <span class="shadow-text__HiddenText">@ViewBag.Player.Nickname</span>
                        <span class="shadow-text__Text">@ViewBag.Player.Nickname</span>
                        <span class="shadow-text__Shadow">@ViewBag.Player.Nickname</span>
                    </span>
                </h1>
                <h2 class="sub-header-text__SubHeaderText">
                    <span class="shadow-text__Container">
                        <span class="shadow-text__HiddenText">Và thế là xong! Bạn có thấy biệt danh của mình trên màn hình không?</span>
                        <span class="shadow-text__Text">Và thế là xong! Bạn có thấy biệt danh của mình trên màn hình không?</span>
                        <span class="shadow-text__Shadow">Và thế là xong! Bạn có thấy biệt danh của mình trên màn hình không?</span>
                    </span>
                </h2>
            </div>
            `);
        } else {
            $("#avatar-current").remove();
            $(".avatar-content__AvatarMenuContainer").remove();
            $(".instructions-with-avatar__TextContent").remove();
            $(".instructions-with-avatar__PageMainContent").append(`<div class="instructions-with-avatar__TextContent">
                    <h1 class="header-text__HeaderText">
                        <span class="shadow-text__Container">
                            <span class="shadow-text__HiddenText">Bạn đã sẵn sàng chưa!</span>
                            <span class="shadow-text__Text">Bạn đã sẵn sàng chưa!</span>
                            <span class="shadow-text__Shadow">Bạn đã sẵn sàng chưa!</span>
                        </span>
                    </h1>
                    <h2 class="sub-header-text__SubHeaderText">
                        <span class="shadow-text__Container">
                            <span class="shadow-text__HiddenText">Và thế là xong! Bạn có thấy biệt danh của mình trên màn hình không?</span>
                            <span class="shadow-text__Text">Và thế là xong! Bạn có thấy biệt danh của mình trên màn hình không?</span>
                            <span class="shadow-text__Shadow">Và thế là xong! Bạn có thấy biệt danh của mình trên màn hình không?</span>
                        </span>
                    </h2>
                </div>`);
            $(".instructions__PageWrapper").append(` <div class="bottom-bar__BottomBar">
                <div class="bottom-bar__NameWrapper">
                            <span class="bottom-bar__NicknameSection">@ViewBag.Player.Nickname</span>
                </div>
            </div>`);
            
        }
    }
</script>