@{
    Layout = "_LayoutUser";
    ViewBag.Title = "Nhóm sở hữu";
    @inject Microsoft.AspNetCore.Http.IHttpContextAccessor HttpContextAccessor;
    var currentPath = HttpContextAccessor.HttpContext.Request.Path.Value;
}
@model ICollection<EduQuiz.Models.EF.Group>
@section styles {
    <link href="~/src/css/library.css" rel="stylesheet" />
    <link href="~/src/css/group.css" rel="stylesheet" />
}
<div class="content" style="padding:0;margin-top:63px;">
    <div class="layout-library">
        <div class="col-md-3 sidebar-wrapper__library" style="min-height:400px;padding:0;">
            <div class="layout-card" style="padding:0;margin:0;height:calc(100vh - 63px) ">
                <div class="sidebar-wrapper__library-Block">
                    <ul class="sidebar-Link__Container">
                        <li class="sidebar-Link__Wrapper">
                            <a class="@(string.IsNullOrEmpty(currentPath) || currentPath == "/groups/owned" ? "active" : "")" href="@Url.Action("GroupOwned","Group")">
                                <span class="sidebar-Link__Icon">
                                    <svg viewBox="0 0 32 32" focusable="false" stroke="none" stroke-width="0" aria-hidden="true"><title>Icon</title><path d="M26,16 C24.897,16 24,15.103 24,14 C24,12.897 24.897,12 26,12 C27.103,12 28,12.897 28,14 C28,15.103 27.103,16 26,16 L26,16 Z M10,23 C10,22.298 10.127,21.627 10.35,21 C10.487,20.615 10.661,20.248 10.87,19.904 C11.923,18.167 13.825,17 16,17 C18.175,17 20.077,18.167 21.13,19.904 C21.339,20.248 21.513,20.615 21.65,21 C21.873,21.627 22,22.298 22,23 L10,23 Z M16,9 C17.654,9 19,10.346 19,12 C19,13.654 17.654,15 16,15 C14.346,15 13,13.654 13,12 C13,10.346 14.346,9 16,9 L16,9 Z M6,16 C4.897,16 4,15.103 4,14 C4,12.897 4.897,12 6,12 C7.103,12 8,12.897 8,14 C8,15.103 7.103,16 6,16 L6,16 Z M28.793,16.855 C29.536,16.128 30,15.119 30,14 C30,11.794 28.206,10 26,10 C23.794,10 22,11.794 22,14 C22,15.119 22.464,16.128 23.207,16.855 C22.795,17.133 22.444,17.486 22.132,17.871 C21.367,16.958 20.4,16.223 19.305,15.723 C20.336,14.807 21,13.485 21,12 C21,9.243 18.757,7 16,7 C13.243,7 11,9.243 11,12 C11,13.485 11.664,14.807 12.695,15.723 C11.6,16.223 10.633,16.958 9.868,17.871 C9.556,17.486 9.205,17.133 8.793,16.855 C9.536,16.128 10,15.119 10,14 C10,11.794 8.206,10 6,10 C3.794,10 2,11.794 2,14 C2,15.119 2.464,16.128 3.207,16.855 C1.876,17.754 1,19.277 1,21 L3,21 C3,19.346 4.346,18 6,18 C7.198,18 8.227,18.711 8.707,19.729 C8.257,20.729 8,21.834 8,23 L8,24 C8,24.552 8.448,25 9,25 L23,25 C23.552,25 24,24.552 24,24 L24,23 C24,21.834 23.743,20.729 23.293,19.729 C23.773,18.711 24.802,18 26,18 C27.654,18 29,19.346 29,21 L31,21 C31,19.277 30.124,17.754 28.793,16.855 L28.793,16.855 Z" style="fill: rgb(110, 110, 110);"></path></svg>
                                </span>
                                <span class="ml-2">Nhóm sở hữu</span>
                            </a>
                        </li>
                        <li class="sidebar-Link__Wrapper">
                            <a class="@(string.IsNullOrEmpty(currentPath) || currentPath == "/groups/joined" ? "active" : "")" href="@Url.Action("Index","Group")">
                                <span class="sidebar-Link__Icon">
                                    <svg viewBox="0 0 32 32" focusable="false" stroke="none" stroke-width="0" aria-hidden="true"><title>Icon</title><path d="M16,14 C17.6568542,14 19,12.6568542 19,11 C19,9.34314575 17.6568542,8 16,8 C14.3431458,8 13,9.34314575 13,11 C13,12.6568542 14.3431458,14 16,14 Z M16,16 C13.2385763,16 11,13.7614237 11,11 C11,8.23857625 13.2385763,6 16,6 C18.7614237,6 21,8.23857625 21,11 C21,13.7614237 18.7614237,16 16,16 Z M16,19 C13.0269583,19 10.5610282,20.4075601 9.52516483,22.3125 L22.4748352,22.3125 C21.4389718,20.4075601 18.9730417,19 16,19 Z M25,24.3125 L7,24.3125 C7,20.2739178 11.0294373,17 16,17 C20.9705627,17 25,20.2739178 25,24.3125 Z" style="fill: rgb(110, 110, 110);"></path></svg>
                                </span>
                                <span class="ml-2">Nhóm đã tham gia</span>
                            </a>
                        </li>
                    </ul>
                    <div class="library-sidebar__Separator"></div>

                </div>
            </div>
        </div>
        <div class="library-layout__Content">
            <div class="library-eduquiz__Content">
                <div class="group__Filter">
                    <div class="styles__TextField">
                        <input class="input__Search" placeholder="Tìm kiếm" onkeyup="filterCards()" />
                        <span class="icon_Field"><svg viewBox="0 0 32 32" focusable="false" stroke="none" stroke-width="0" aria-hidden="true"><title>Icon</title><path d="M25.707,24.293 L20.314,18.9 C21.403,17.504 22,15.799 22,14 C22,11.863 21.167,9.854 19.656,8.344 C18.146,6.832 16.137,6 14,6 C11.863,6 9.854,6.832 8.344,8.344 C6.833,9.854 6,11.863 6,14 C6,16.137 6.833,18.146 8.344,19.656 C9.854,21.168 11.863,22 14,22 C15.799,22 17.504,21.404 18.9,20.314 L24.293,25.706 L25.707,24.293 Z M14,20 C12.397,20 10.891,19.376 9.758,18.243 C8.624,17.11 8,15.603 8,14 C8,12.398 8.624,10.891 9.758,9.758 C10.891,8.624 12.397,8 14,8 C15.603,8 17.109,8.624 18.242,9.758 C19.376,10.891 20,12.398 20,14 C20,15.603 19.376,17.11 18.242,18.243 C17.109,19.376 15.603,20 14,20 Z" style="fill: rgb(110, 110, 110);"></path></svg></span>
                    </div>
                    <button class="btn" data-toggle="modal" data-target="#modalCreateGroup">Tạo nhóm</button>

                </div>
                @if (Model.Count != 0)
                {
                    <ul class="group-list-layout">
                        @foreach(var group in Model)
                        {
                            <li class="group-card">
                                <a href="@Url.Action("GroupActivity","Group", new {id = group.Uuid})" class="group-card__Link">
                                    <div class="group-avatar">
                                        <img class="group-avatar__Img" src="/src/img/EduQuizDefault.png" />
                                    </div>
                                    <div class="group-name">@group.Name</div>
                                </a>
                            </li>
                        }
                    </ul>
                }else{
                    <div class="group-empty-view">
                        <div class="group-empty-view__Container">
                            <div class="groups-empty-view__Icons">
                                <div class="groups-empty-view__Icon">
                                    <svg width="88" height="48" viewBox="0 0 88 48" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="72" cy="16" r="15" fill="white" stroke="#F2F2F2" stroke-width="2"></circle><path fill-rule="evenodd" clip-rule="evenodd" d="M68.25 13C68.25 15.0711 69.9289 16.75 72 16.75C74.0711 16.75 75.75 15.0711 75.75 13C75.75 10.9289 74.0711 9.25 72 9.25C69.9289 9.25 68.25 10.9289 68.25 13ZM72 17.5C68.2721 17.5 65.25 19.9554 65.25 22.9844H78.75C78.75 19.9554 75.7279 17.5 72 17.5Z" fill="#45A3E5"></path><circle cx="16" cy="32" r="15" fill="white" stroke="#F2F2F2" stroke-width="2"></circle><path fill-rule="evenodd" clip-rule="evenodd" d="M12.25 29C12.25 31.0711 13.9289 32.75 16 32.75C18.0711 32.75 19.75 31.0711 19.75 29C19.75 26.9289 18.0711 25.25 16 25.25C13.9289 25.25 12.25 26.9289 12.25 29ZM16 33.5C12.2721 33.5 9.25 35.9554 9.25 38.9844H22.75C22.75 35.9554 19.7279 33.5 16 33.5Z" fill="#45A3E5"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M40.518 18C40.518 22.1421 43.8795 25.5 48.0262 25.5C52.1728 25.5 55.5344 22.1421 55.5344 18C55.5344 13.8579 52.1728 10.5 48.0262 10.5C43.8795 10.5 40.518 13.8579 40.518 18ZM52.5311 18C52.5311 20.4853 50.5142 22.5 48.0262 22.5C45.5382 22.5 43.5213 20.4853 43.5213 18C43.5213 15.5147 45.5382 13.5 48.0262 13.5C50.5142 13.5 52.5311 15.5147 52.5311 18ZM48.0262 30C43.5618 30 39.8588 32.1113 38.3034 34.9688H57.749C56.1935 32.1113 52.4906 30 48.0262 30ZM34.5115 37.9688H61.5409C61.5409 31.9109 55.4902 27 48.0262 27C40.5622 27 34.5115 31.9109 34.5115 37.9688Z" fill="#0542B9"></path></svg>
                                    <div class="groups-empty-view__IconLabel">Tương tác</div>
                                </div>
                                <div class="groups-empty-view__Icon">
                                    <svg width="88" height="48" viewBox="0 0 88 48" fill="none" xmlns="http://www.w3.org/2000/svg"><rect y="28" width="72" height="20" rx="4" fill="white"></rect><rect x="32" y="33" width="34" height="4" rx="2" fill="#F2F2F2"></rect><rect x="32" y="33" width="16" height="4" rx="2" fill="#B2B2B2"></rect><rect x="32" y="39" width="16" height="4" rx="2" fill="#F2F2F2"></rect><path d="M0 32C0 29.7909 1.79086 28 4 28H28V48H0V32Z" fill="#CCCCCC"></path><g clip-path="url(#clip0_635_22135)"><rect x="0.333374" width="80" height="24" rx="4" fill="white"></rect><rect x="36" y="7" width="38" height="4" rx="2" fill="#0542B9"></rect><rect x="36" y="13" width="16" height="4" rx="2" fill="#F2F2F2"></rect><path d="M0 4C0 1.79086 1.79086 0 4 0H32V24H0V4Z" fill="#45A3E5"></path><path d="M20.4996 6L22.996 8.2709L13.8009 18.3852L8.5 13.4407L10.8856 11.0538L13.6855 13.4964L20.4996 6Z" fill="white"></path></g><defs><clipPath id="clip0_635_22135"><rect width="80" height="24" rx="4" fill="white"></rect></clipPath></defs></svg>
                                    <div class="groups-empty-view__IconLabel">Giao bài tập</div>
                                </div>
                                <div class="groups-empty-view__Icon">
                                    <svg width="89" height="48" viewBox="0 0 89 48" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="0.000244141" y="16" width="40" height="8" rx="4" fill="white"></rect><rect x="0.000244141" y="32" width="88" height="8" rx="4" fill="white"></rect><rect x="0.000244141" width="72" height="8" rx="4" fill="#45A3E5"></rect><mask id="mask0_635_22151" maskUnits="userSpaceOnUse" x="33" y="9" width="31" height="30" style="mask-type: alpha;"><path fill-rule="evenodd" clip-rule="evenodd" d="M60.0002 16.5585C60.0002 17.016 59.7947 17.445 59.4377 17.73L56.9912 19.6875C56.9927 19.6245 57.0002 19.563 57.0002 19.5V13.5H60.0002V16.5585ZM48.0002 25.5C44.6912 25.5 42.0002 22.809 42.0002 19.5V12H54.0002V19.5C54.0002 22.809 51.3092 25.5 48.0002 25.5ZM36.5642 17.7315C36.2057 17.445 36.0002 17.016 36.0002 16.5585V13.5H39.0002V19.5C39.0002 19.563 39.0077 19.6245 39.0092 19.6875L36.5642 17.7315ZM51.0002 36H45.0002V34.5H51.0002V36ZM61.5002 10.5H56.5832C56.0627 9.6075 55.1057 9 54.0002 9H42.0002C40.8947 9 39.9377 9.6075 39.4172 10.5H34.5002C33.6722 10.5 33.0002 11.172 33.0002 12V16.5585C33.0002 17.9325 33.6152 19.2135 34.6892 20.073L40.9562 25.086C42.3107 26.79 44.2652 27.9885 46.5002 28.365V31.5H43.5002C42.6722 31.5 42.0002 32.172 42.0002 33V36H40.5002V39H43.5002H52.5002H55.5002V36H54.0002V33C54.0002 32.172 53.3282 31.5 52.5002 31.5H49.5002V28.365C51.7352 27.9885 53.6897 26.79 55.0442 25.086L61.3127 20.073C62.3852 19.2135 63.0002 17.9325 63.0002 16.5585V12C63.0002 11.172 62.3282 10.5 61.5002 10.5Z" fill="white"></path></mask><g mask="url(#mask0_635_22151)"><rect width="48" height="48" transform="translate(24.0002)" fill="#0542B9"></rect><rect x="24.0002" width="48" height="48" fill="#0542B9"></rect></g></svg>
                                    <div class="groups-empty-view__IconLabel">Hoàn thành</div>
                                </div>
                            </div>
                            <div class="groups-empty-view__Title">
                                Trong Nhóm, bạn có thể tương tác với nhóm của mình, chia sẻ nội dung, vui chơi và chơi cùng nhau. Hãy bắt đầu bằng cách tạo nhóm đầu tiên của bạn!
                            </div>
                            <button class="btn">Tạo nhóm</button>
                        </div>
                    </div>
                }
            </div>
        </div>
    </div>
</div>
<script src="~/src/js/mainlibrary.js"></script>
<script>
    $(document).on("click","#btn-submit",function () {
        const name = $("#namegroup").val();
        console.log("ok")
        if (name == "") {
            openToast('info', 'Lỗi', 'Vui lòng nhập tên nhóm!', 3000);
            return;
        }
        $.ajax({
            type: "POST",
            url: "@Url.Action("CreateGroup", "Group")",
            data: {
                name: name
            },
            success: function (response) {
                if (response.redirectUrl) {
                    Swal.fire({
                        title: 'Hết phiên đăng nhập',
                        text: 'Vui lòng đăng nhập lại',
                        icon: 'warning',
                        confirmButtonText: 'OK'
                    }).then((result) => {
                        if (result.isConfirmed) {
                            window.location.href = response.redirectUrl;
                        }
                    });
                } else {
                    if (response.status == true) {
                        window.location.href = `/groups/${response.data}/activity`
                    }
                }
            }
        })
    })
    function filterCards() {
        const input = $(".input__Search").val().toLowerCase();
        const cards = $(".group-card");
        cards.each(function () {
            const title = $(this).find(".group-name").text().toLowerCase();
            if (title.includes(input)) {
                $(this).show();
            } else {
                $(this).hide();
            }
        });
    }
</script>